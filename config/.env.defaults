###############################################################################
# TRADINGSYSTEM – DEFAULT CONFIGURATION (.env.defaults)
#
# Este arquivo contém APENAS valores não-sensíveis (portas, URLs, flags).
# Secrets (API keys, passwords, tokens) devem estar em .env (não commitado).
#
# IMPORTANTE:
#   - Este arquivo É VERSIONADO (git add config/.env.defaults)
#   - NUNCA inclua secrets neste arquivo
#   - Para overrides locais, use .env.local (gitignored)
#
# Precedência de carregamento:
#   1. config/.env.defaults (este arquivo)
#   2. .env.local (overrides locais opcionais)
#   3. .env (secrets - maior prioridade)
#
# Última atualização: 20251107-201508
###############################################################################


###############################################################################
# TRADINGSYSTEM – SENSITIVE CREDENTIALS (.env)
#
# This file now contains ONLY secrets. Non-secret defaults live in:
#   - config/.env.defaults  (versioned default values)
#   - .env.local            (local overrides without secrets)
#
# A backup of your previous .env is stored at:
#   .env.backup-20251104-122019
#
# Do not commit this file. Keep it private.
###############################################################################

# ==== External AI & API Providers ====
# OPENAI_API_KEY=CHANGE_ME  # Secret - configure in .env
# LANGSMITH_API_KEY=CHANGE_ME  # Secret - configure in .env
# ANTHROPIC_API_KEY=CHANGE_ME  # Secret - configure in .env
# FIRECRAWL_API_KEY=CHANGE_ME  # Secret - configure in .env
# GITHUB_TOKEN=CHANGE_ME  # Secret - configure in .env

# ==== Observability & Admin Access ====
# SLACK_WEBHOOK_URL=CHANGE_ME  # Secret - configure in .env
# SENTRY_AUTH_TOKEN=CHANGE_ME  # Secret - configure in .env
# GF_SECURITY_ADMIN_PASSWORD=CHANGE_ME  # Secret - configure in .env
PGADMIN_DEFAULT_EMAIL=marcelo.terra@gmail.com
# PGADMIN_DEFAULT_PASSWORD=CHANGE_ME  # Secret - configure in .env
PGADMIN_PORT=5050
PGWEB_PORT=8081
PGADMIN_HOST_PORT=5050
PGWEB_HOST_PORT=8081
ADMINER_HOST_PORT=8082

# ==== Core Platform Secrets ====
# GATEWAY_SECRET_TOKEN=CHANGE_ME  # Secret - configure in .env
# API_SECRET_TOKEN=CHANGE_ME  # Secret - configure in .env
# INTER_SERVICE_SECRET=CHANGE_ME  # Secret - configure in .env

# ==== Frontend & Documentation (Vite) ====
VITE_APP_ENV=development
VITE_USE_UNIFIED_DOMAIN=false
VITE_API_BASE_URL=http://localhost:3401
VITE_WORKSPACE_API_URL=/api/workspace  # Relative path - proxied by Vite to workspace-api:3200/api
VITE_FIRECRAWL_PROXY_URL=http://localhost:3600
VITE_AGENTS_SCHEDULER_URL=http://localhost:8199
VITE_AGNO_AGENTS_URL=http://localhost:8201
VITE_LLAMAINDEX_QUERY_URL=http://localhost:8202
VITE_LLAMAINDEX_JWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkYXNoYm9hcmQiLCJleHAiOjE3OTMyNDU1NjR9.XbMb7jduH5DP3ErWodUZ7AWSn0l02aKGr1_BTbH1vgs
VITE_RAG_COLLECTIONS_URL=http://localhost:3403
VITE_QDRANT_URL=http://localhost:6333
# VITE_GATEWAY_TOKEN=CHANGE_ME  # Secret - configure in .env
VITE_TELEGRAM_GATEWAY_API_URL="http://localhost:4010"
# VITE_TELEGRAM_GATEWAY_API_TOKEN=CHANGE_ME  # Secret - configure in .env
# VITE_TP_CAPITAL_API_KEY=CHANGE_ME  # Secret - configure in .env
VITE_KESTRA_BASE_URL=http://localhost:8180
VITE_KESTRA_MANAGEMENT_URL=http://localhost:8685
VITE_N8N_URL=http://localhost:3680/n8n
VITE_N8N_USE_PROXY=true
VITE_N8N_BASIC_AUTH_USER=marcelo.terra@gmail.com
# VITE_N8N_BASIC_AUTH_PASSWORD=CHANGE_ME  # Secret - configure in .env
VITE_N8N_PATH=/home/workflows
N8N_E2E_EMAIL=marcelo.terra@gmail.com
# N8N_E2E_PASSWORD=CHANGE_ME  # Secret - configure in .env
VITE_DOCUSAURUS_URL=/docs
DOCS_PORT=3404
VITE_PGADMIN_URL=http://localhost:5050
VITE_PGWEB_URL=http://localhost:8081
VITE_ADMINER_URL=http://localhost:8082

# ==== Crawler Course Meta Stack (app/crawler-course-meta) ====
CCM_API_PORT=9180
CCM_FRONTEND_PORT=3304
CCM_PROMETHEUS_PORT=9390

# Antes (remover ou comentar):
# DB_TOOLS_API_PORT=3909
# DB_TOOLS_API_TOKEN=devlocal-db-tools-token
# DB_TOOLS_API_LOG_LEVEL=info

# Depois (adicionar):
LAUNCHER_API_PORT=3909
# LAUNCHER_API_TOKEN=CHANGE_ME  # Secret - configure in .env
LAUNCHER_API_LOG_LEVEL=info

# Frontend (se estiver usando):
VITE_LAUNCHER_API_URL=http://localhost:3909
# VITE_LAUNCHER_API_TOKEN=CHANGE_ME  # Secret - configure in .env


# ==== RAG & AI Stack ====


# -- Ollama
OLLAMA_MODEL=llama3.1
OLLAMA_EMBED_MODEL=nomic-embed-text
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

# -- Cache Layers & Redis
# Max entries in L1 cache
CACHE_MEMORY_MAX=1000
# L1 TTL in milliseconds (5 min)
CACHE_MEMORY_TTL=300000
# L2 TTL in seconds (10 min)
CACHE_REDIS_TTL=600
# Max cached embeddings
EMBEDDING_CACHE_SIZE=10000
# Max cached query results
QUERY_CACHE_SIZE=5000
# Max Qdrant connections
CONNECTION_POOL_SIZE=20

RAG_REDIS_PORT=6380
REDIS_URL=redis://rag-redis:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_REPLICA_PORT=6380
REDIS_ENABLED=true
# REDIS_PASSWORD=CHANGE_ME  # Secret - configure in .env
REDIS_CACHE_TTL=600

# ==== Shared Databases & Service Ports ====
# FRONTEND_APPS_DB_READONLY_PASS=CHANGE_ME  # Secret - configure in .env
# APP_DOCUMENTATION_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env
# FIRECRAWL_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env
# LANGGRAPH_POSTGRES_PASSWORD=CHANGE_ME  # Secret - configure in .env
TIMESCALEDB_HOST=localhost
TIMESCALEDB_PORT=7000
TIMESCALEDB_USER=timescale
# TIMESCALEDB_PASSWORD=CHANGE_ME  # Secret - configure in .env
TIMESCALEDB_DATABASE=APPS-TPCAPITAL
# TIMESCALE_POSTGRES_PASSWORD=CHANGE_ME  # Secret - configure in .env
TIMESCALEDB_BACKUP_PORT=7001
POSTGRES_LANGGRAPH_PORT=7002
KONG_DB_PORT=7003
# KONG_PG_PASSWORD=CHANGE_ME  # Secret - configure in .env
TIMESCALEDB_EXPORTER_PORT=7200
QUESTDB_ILP_PORT=7011
QUESTDB_INFLUX_PORT=7012

# ==== Telegram Stack ====
# -- Bot & MTProto Credentials
TELEGRAM_API_ID=23522437
TELEGRAM_API_HASH=c5f138fdd8e50f3f71462ce577cb3e60
TELEGRAM_PHONE_NUMBER=+5567991908000
TELEGRAM_SESSION=1AQAOMTQ5LjE1NC4xNzUuNTYBu3mZj6zXwwH5SxnptuRcyuvSvuJfi7CzRuhTVryYrC/+RoHqZqTI8txSXgG8+mkh6bKVvzYFa1cVhHPz7yn8iYTDMCIYbxQh778AnXK28OMVv8hqKaVDx96pduo68ogs5WrO73MilC7bv+RAQyP5lEjSydB+UFhvIoDOTnAw7ABEez0ZsJP+p44aRpFYm+62wDwkNGMnHkS8AeheYqD6XSmHFCuUmMsQqxFcbRY943x1JXeFvh0JWQu3bepVS0UsAhFKx4sy73Ov8lbXXGZMbizZyNx4saCKY/vUE9xG5zwyG+V6tRmlckdv5R01SPNRGYd3zL+ZAPcQf7/DVbEnRDw=
TELEGRAM_SIGNALS_CHANNEL_ID=-1001649127710
# TELEGRAM_SESSION_ENCRYPTION_KEY=CHANGE_ME  # Secret - configure in .env
# TELEGRAM_BOT_TOKEN=CHANGE_ME  # Secret - configure in .env
# TELEGRAM_INGESTION_BOT_TOKEN=CHANGE_ME  # Secret - configure in .env
# TELEGRAM_FORWARDER_BOT_TOKEN=CHANGE_ME  # Secret - configure in .env

# -- Gateway Secrets & URLs
TELEGRAM_GATEWAY_URL=http://telegram-gateway-api:4010
TELEGRAM_GATEWAY_PORT=4010
# TELEGRAM_GATEWAY_API_KEY=CHANGE_ME  # Secret - configure in .env
# TELEGRAM_GATEWAY_API_TOKEN=CHANGE_ME  # Secret - configure in .env
GATEWAY_PORT=4007

# -- Gateway Database (TimescaleDB 5434)
TELEGRAM_DB_USER=telegram
# TELEGRAM_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env
TELEGRAM_GATEWAY_DB_URL=postgresql://telegram:NYMBgrENUZP8FqUHN1Yo8sdzSfs3kLhp@localhost:5434/telegram_gateway
TELEGRAM_GATEWAY_DB_HOST=localhost
TELEGRAM_GATEWAY_DB_PORT=5434
TELEGRAM_GATEWAY_DB_NAME=telegram_gateway
TELEGRAM_GATEWAY_DB_USER=telegram
# TELEGRAM_GATEWAY_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env
TELEGRAM_GATEWAY_DB_SCHEMA=telegram_gateway
TELEGRAM_GATEWAY_DB_TABLE=messages

# -- TP Capital Polling Mirror (TimescaleDB 5434)
GATEWAY_DATABASE_URL=postgresql://telegram:NYMBgrENUZP8FqUHN1Yo8sdzSfs3kLhp@localhost:5434/telegram_gateway
GATEWAY_DATABASE_HOST=localhost
GATEWAY_DATABASE_PORT=5434
GATEWAY_DATABASE_NAME=telegram_gateway
GATEWAY_DATABASE_USER=telegram
# GATEWAY_DATABASE_PASSWORD=CHANGE_ME  # Secret - configure in .env
GATEWAY_DATABASE_SCHEMA=telegram_gateway

# -- RabbitMQ
RABBITMQ_URL=amqp://telegram:wVsBzAJzhyt148XZ/VoilpqlQfEmQpKf@localhost:5672/telegram
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=telegram
# RABBITMQ_PASSWORD=CHANGE_ME  # Secret - configure in .env
RABBITMQ_VHOST=telegram
# TELEGRAM_RABBITMQ_PASSWORD=CHANGE_ME  # Secret - configure in .env

# -- Redis Cache Ports
TELEGRAM_REDIS_MASTER_PORT=6379
TELEGRAM_REDIS_REPLICA_PORT=6386
TELEGRAM_REDIS_SENTINEL_PORT=26379

# -- Startup Sync Settings
TELEGRAM_GATEWAY_SYNC_ON_STARTUP=true
TELEGRAM_GATEWAY_STARTUP_SYNC_DELAY=5000
TELEGRAM_GATEWAY_STARTUP_SYNC_LIMIT=500
TELEGRAM_GATEWAY_STARTUP_SYNC_CONCURRENCY=3

# -- Monitoring Ports
TELEGRAM_PROMETHEUS_PORT=9193
TELEGRAM_POSTGRES_EXPORTER_PORT=9188

# ==== TP Capital Stack ====
# TP_CAPITAL_API_KEY=CHANGE_ME  # Secret - configure in .env
TP_CAPITAL_DB_USER=tp_capital
TP_CAPITAL_DB_NAME=tp_capital_db
TP_CAPITAL_DB_PORT=5437
TP_CAPITAL_DB_HOST=tp-capital-pgbouncer
TP_CAPITAL_DB_STRATEGY=timescale
TP_CAPITAL_PGBOUNCER_PORT=6435
TP_CAPITAL_REDIS_PORT=6381
TP_CAPITAL_REDIS_REPLICA_PORT=6382

# ==== Workspace & Neon Stack ====
LIBRARY_DB_STRATEGY=postgresql

# Neon Connection (internal Docker network)
NEON_HOST=workspace-db-compute
NEON_PORT=55432
NEON_DATABASE=workspace
NEON_USER=postgres
# NEON_PASSWORD=CHANGE_ME  # Secret - configure in .env
NEON_SCHEMA=workspace
NEON_DATABASE_URL=postgresql://postgres:neon_secure_pass@workspace-db-compute:55432/workspace
NEON_POOL_MAX=50
NEON_POOL_MIN=2
NEON_IDLE_TIMEOUT=30000
NEON_CONNECTION_TIMEOUT=5000
NEON_STATEMENT_TIMEOUT=30000
NEON_QUERY_TIMEOUT=30000
NEON_SSL=false

# Workspace API
WORKSPACE_PORT=3200
WORKSPACE_EXTERNAL_PORT=3200
# WORKSPACE_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env

# HTTP & Observability Controls
CORS_ORIGIN=http://localhost:3103,http://localhost:3400,http://localhost:3401
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=120
LOG_LEVEL=info
METRICS_ENABLED=true
CORRELATION_ID_HEADER=x-correlation-id

# PostgreSQL (Workspace)
POSTGRES_HOST=workspace-db
POSTGRES_PORT=5432
POSTGRES_DATABASE=workspace
POSTGRES_USER=postgres
# POSTGRES_PASSWORD=CHANGE_ME  # Secret - configure in .env
POSTGRES_SCHEMA=workspace
POSTGRES_POOL_MAX=50
POSTGRES_POOL_MIN=2

# ==== Kestra Workflow Orchestration ====
KESTRA_DB_HOST=kestra-postgres
KESTRA_DB_PORT=5432
KESTRA_DB_NAME=kestra
KESTRA_DB_USER=kestra
# KESTRA_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env
KESTRA_BASICAUTH_USERNAME=admin
# KESTRA_BASICAUTH_PASSWORD=CHANGE_ME  # Secret - configure in .env
KESTRA_HTTP_PORT=8180
KESTRA_MANAGEMENT_PORT=8181
KESTRA_WORKDIR_DIR=./tools/kestra/workdir
KESTRA_STORAGE_DIR=./tools/kestra/storage

# TP-Capital TimescaleDB Password (REQUIRED)
# TP_CAPITAL_DB_PASSWORD=CHANGE_ME  # Secret - configure in .env

# TP Capital API URL (Dashboard frontend)
# Browser-facing URL (relative path - proxied by Vite to tp-capital-api:4005)
VITE_TP_CAPITAL_API_URL=/api/tp-capital

# Frontend (Vite) - Course Crawler API (use service name for Docker network)
# VITE_COURSE_CRAWLER_API_URL empty = use relative path (nginx proxy)
VITE_COURSE_CRAWLER_APP_URL=http://localhost:4201
VITE_DOCKER_CONTROL_URL=http://127.0.0.1:9876
COURSE_CRAWLER_MAX_CLASSES_PER_MODULE=50
COURSE_CRAWLER_APP_PORT=4201
COURSE_CRAWLER_TIMEOUT_MS=3600000

# Course Crawler Backend API
COURSE_CRAWLER_API_PORT=3601
COURSE_CRAWLER_DATABASE_URL=postgresql://postgres:coursecrawler@course-crawler-db:5432/coursecrawler
COURSE_CRAWLER_NEON_DATABASE_URL=postgresql://postgres:coursecrawler@course-crawler-db:5432/coursecrawler
# COURSE_CRAWLER_ENCRYPTION_KEY=CHANGE_ME  # Secret - configure in .env
COURSE_CRAWLER_OUTPUT_BASE=/home/marce/Projetos/TradingSystem/outputs/course-crawler
COURSE_CRAWLER_CLI_PATH=/home/marce/Projetos/TradingSystem/apps/course-crawler/dist/index.js
COURSE_CRAWLER_MAX_CONCURRENCY=1

# ==== WAHA – WhatsApp HTTP API Stack ====
WAHA_IMAGE=devlikeapro/waha:noweb
WAHA_PORT=3310
WAHA_HOST_BIND=127.0.0.1
WAHA_TZ=America/Sao_Paulo
# WAHA_API_KEY=CHANGE_ME  # Secret - configure in .env
WAHA_API_KEY_PLAIN=ts_waha_api_IWkx12Sm0Je9rTdK6fan0CQD5A7ojuAPBdD3L9YLT04
WAHA_DASHBOARD_USERNAME=admin
# WAHA_DASHBOARD_PASSWORD=CHANGE_ME  # Secret - configure in .env
WAHA_DASHBOARD_ENABLED=true
WHATSAPP_SWAGGER_USERNAME=admin
# WHATSAPP_SWAGGER_PASSWORD=CHANGE_ME  # Secret - configure in .env
WHATSAPP_SWAGGER_ENABLED=true
WAHA_DEFAULT_ENGINE=NOWEB
WAHA_BASE_URL=http://localhost:3310
WAHA_PUBLIC_URL=http://localhost:3310
WAHA_HOSTNAME=0.0.0.0
WAHA_INTERNAL_PORT=3000
WAHA_MEDIA_STORAGE=S3
WAHA_PRINT_QR=false
WAHA_LOG_FORMAT=JSON
WAHA_LOG_LEVEL=info
WAHA_S3_PROXY_FILES=true

WAHA_POSTGRES_HOST_BIND=127.0.0.1
WAHA_POSTGRES_PORT=5438
WAHA_POSTGRES_DB=waha
WAHA_POSTGRES_USER=waha
# WAHA_POSTGRES_PASSWORD=CHANGE_ME  # Secret - configure in .env

WAHA_MINIO_HOST_BIND=127.0.0.1
WAHA_MINIO_API_PORT=9300
WAHA_MINIO_CONSOLE_HOST_BIND=127.0.0.1
WAHA_MINIO_CONSOLE_PORT=9301
WAHA_MINIO_BUCKET=waha-media
WAHA_MINIO_REGION=us-east-1
WAHA_MINIO_ROOT_USER=wahaadmin
# WAHA_MINIO_ROOT_PASSWORD=CHANGE_ME  # Secret - configure in .env

WAHA_APPS_ENABLED=false
WAHA_API_KEY_PLAIN=ts_waha_api_IWkx12Sm0Je9rTdK6fan0CQD5A7ojuAPBdD3L9YLT04


WAHA_WEBHOOK_HOST_BIND=127.0.0.1
WAHA_WEBHOOK_PORT=3908
# WAHA_WEBHOOK_TOKEN=CHANGE_ME  # Secret - configure in .env
WAHA_HOOK_URL=http://waha-webhook:3908/webhooks/waha
WAHA_HOOK_EVENTS=message,message.ack,session.status
WAHA_HOOK_CUSTOM_HEADERS="X-WAHA-TOKEN:webhooktoken"

# ==== n8n Automation Stack ====
N8N_IMAGE=n8nio/n8n:1.78.1
N8N_HOST_BIND=127.0.0.1
N8N_HOST=localhost
N8N_PROTOCOL=http
N8N_PORT=3680
N8N_INTERNAL_PORT=5678
N8N_PATH=/n8n
N8N_BASE_URL=http://localhost:3103/n8n
N8N_EDITOR_BASE_URL=http://localhost:3103/n8n
N8N_API_BASE_URL=http://localhost:3103/n8n/api
N8N_PROXY_TARGET=http://localhost:3680
N8N_WEBHOOK_URL=http://localhost:3103/n8n/
WEBHOOK_URL=http://localhost:3103/n8n/
N8N_TZ=America/Sao_Paulo
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=marcelo.terra@gmail.com
# N8N_BASIC_AUTH_PASSWORD=CHANGE_ME  # Secret - configure in .env
# N8N_ENCRYPTION_KEY=CHANGE_ME  # Secret - configure in .env
N8N_USER_FOLDER=/home/node/.n8n
N8N_LOG_LEVEL=info
N8N_METRICS=true
N8N_METRICS_INCLUDE_IDENTIFIERS=false
N8N_DIAGNOSTICS_ENABLED=false
N8N_PERSONALIZATION_ENABLED=false
N8N_VERSION_NOTIFICATIONS_ENABLED=false
N8N_HIDE_USAGE_PAGE=true
N8N_SKIP_WEBHOOK_DEREGISTRATION_ON_SHUTDOWN=true
N8N_HIRING_BANNER_ENABLED=false
N8N_SECURE_COOKIE=false
N8N_SESSION_COOKIE_DOMAIN=localhost
N8N_SESSION_COOKIE_SAME_SITE=lax
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
N8N_DISABLE_UI_SECURITY=true
N8N_SECURITY_ALLOW_EMBEDDING_IN_IFRAME=true
N8N_PREVIEW_MODE=true
N8N_QUEUE_HEALTH_CHECK_ACTIVE=true
N8N_EXECUTIONS_MODE=queue
N8N_RUNNERS_ENABLED=true
OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
N8N_WORKER_CONCURRENCY=5
N8N_REDIS_DB=0
N8N_REDIS_TIMEOUT_THRESHOLD=30000
N8N_POSTGRES_IMAGE=postgres:16-alpine
N8N_POSTGRES_HOST_BIND=127.0.0.1
N8N_POSTGRES_PORT=5442
N8N_POSTGRES_DB=n8n
N8N_POSTGRES_USER=n8n
# N8N_POSTGRES_PASSWORD=CHANGE_ME  # Secret - configure in .env
N8N_POSTGRES_MAX_CONNECTIONS=200
N8N_POSTGRES_SHARED_BUFFERS=256MB

N8N_REDIS_IMAGE=redis:7-alpine
N8N_REDIS_HOST_BIND=127.0.0.1
N8N_REDIS_PORT=6390
# N8N_REDIS_PASSWORD=CHANGE_ME  # Secret - configure in .env

# ============================================================================
# Backend Service URLs (added 2025-11-08)
# ============================================================================

# Telegram Gateway / MTProto Service
MTPROTO_SERVICE_URL=http://localhost:4007
GATEWAY_SERVICE_URL=http://localhost:4007

# RAG System URLs
LLAMAINDEX_QUERY_URL=http://localhost:8202
LLAMAINDEX_INGESTION_URL=http://localhost:8201
QDRANT_URL=http://localhost:6333
OLLAMA_BASE_URL=http://localhost:11434
COLLECTIONS_SERVICE_URL=http://localhost:3402

# Course Crawler API
COURSE_CRAWLER_CORS_ORIGINS=http://localhost:3103,http://localhost:4201
