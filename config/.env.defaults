# ==============================================================================
# TradingSystem ‚Äì Default Environment Configuration
# ==============================================================================
# Valores versionados que servem como padr√£o para scripts e servi√ßos.
# O loader compartilhado (`backend/shared/config/load-env.js`) carrega
# este arquivo automaticamente, seguido de `.env` e `.env.local`.
# Ajustes locais devem ser feitos em `.env.local`.
# ==============================================================================

# ==============================================================================
# üåç GLOBAL SERVICE SETTINGS
# ==============================================================================
ENVIRONMENT=development
TZ=America/Sao_Paulo
NODE_ENV=development
DEBUG=false

# Version tag applied to all custom container images (img-*)
# Update when rebuilding images with scripts/docker/build-images.sh
IMG_VERSION=latest
CHOKIDAR_USEPOLLING=false


# ==============================================================================
# üóÉÔ∏è FRONTEND APPS DATABASE (PostgreSQL 16 + Timescale)
# ==============================================================================
FRONTEND_APPS_DB_HOST=localhost
FRONTEND_APPS_DB_PORT=5444
FRONTEND_APPS_DB_NAME=frontend_apps
FRONTEND_APPS_DB_SUPERUSER=frontend_admin
FRONTEND_APPS_DB_SUPERPASS=change_me_frontend

APP_DOCUMENTATION_DB_USER=app_documentation
APP_DOCUMENTATION_DB_PASSWORD=change_me_documentation
APP_WORKSPACE_DB_USER=app_workspace
APP_WORKSPACE_DB_PASSWORD=change_me_workspace

# ==============================================================================
# üß± TIMESCALEDB CORE (Infra stack)
# ==============================================================================
TIMESCALEDB_HOST=localhost
TIMESCALEDB_PORT=5433
TIMESCALEDB_DATABASE=tradingsystem
TIMESCALEDB_USER=timescale
TIMESCALEDB_PASSWORD=pass_timescale

# ==============================================================================
# üìö SERVICE DATABASE CONNECTIONS (UNIFIED FRONTEND CLUSTER)
# ==============================================================================
LIBRARY_DB_STRATEGY=timescaledb
WORKSPACE_PORT=3200

# Workspace API (schema: workspace)
WORKSPACE_DATABASE_SCHEMA=workspace
WORKSPACE_DATABASE_URL=postgresql://${APP_WORKSPACE_DB_USER}:${APP_WORKSPACE_DB_PASSWORD}@${FRONTEND_APPS_DB_HOST}:${FRONTEND_APPS_DB_PORT}/${FRONTEND_APPS_DB_NAME}?schema=workspace
WORKSPACE_TABLE_NAME=workspace_items
WORKSPACE_DATABASE_POOL_MAX=10
WORKSPACE_DATABASE_TIMEOUT_MS=5000
WORKSPACE_DATABASE_SSL=false

# Documentation API
DOCUMENTATION_DATABASE_SCHEMA=documentation
DOCUMENTATION_DATABASE_URL=postgresql://${APP_DOCUMENTATION_DB_USER}:${APP_DOCUMENTATION_DB_PASSWORD}@${FRONTEND_APPS_DB_HOST}:${FRONTEND_APPS_DB_PORT}/${FRONTEND_APPS_DB_NAME}?schema=documentation
DOCUMENTATION_DATABASE_POOL_MAX=10
DOCUMENTATION_DATABASE_TIMEOUT_MS=5000
DOCUMENTATION_DATABASE_SSL=false

# Firecrawl internal Postgres (dockerized)
FIRECRAWL_POSTGRES_USER=firecrawl
FIRECRAWL_POSTGRES_PASSWORD=change_me_firecrawl_postgres
FIRECRAWL_POSTGRES_DB=postgres
FIRECRAWL_NUQ_DATABASE_URL=postgres://firecrawl:change_me_firecrawl@firecrawl-postgres:5432/postgres

# ==============================================================================
# üîß PGADMIN & DB UI TOOLS
# ==============================================================================
PGADMIN_DEFAULT_EMAIL=admin@example.com
PGADMIN_DEFAULT_PASSWORD=change_me_pgadmin
PGADMIN_LISTEN_PORT=5050
PGADMIN_HOST_PORT=5050
PGWEB_PORT=8081
ADMINER_PORT=8082
AZIMUTT_PORT=8084
AZIMUTT_PHX_HOST=localhost
AZIMUTT_SECRET_KEY_BASE=change_me_azimutt
AZIMUTT_FILE_STORAGE_ADAPTER=local
AZIMUTT_AUTH_PASSWORD=true

# ==============================================================================
# üê≥ QUESTDB CORE
# ==============================================================================
QUESTDB_HTTP_PORT=9002
QUESTDB_PG_PORT=8813
QUESTDB_ILP_PORT=9010
QUESTDB_MIN_PORT=9003
QUESTDB_HTTP_URL=http://localhost:9002

# ==============================================================================
# üåê BACKEND APIS (PORTS & BASE SETTINGS)
# ==============================================================================
TP_CAPITAL_PORT=4005

DOCS_API_PORT=3401
SERVICE_LAUNCHER_PORT=3500

# ==============================================================================
# üî• FIRECRAWL STACK
# ==============================================================================
FIRECRAWL_PROXY_PORT=3600
FIRECRAWL_PROXY_BASE_URL=http://localhost:3002
FIRECRAWL_PROXY_TIMEOUT=30000
FIRECRAWL_PROXY_RATE_LIMIT_WINDOW_MS=60000
FIRECRAWL_PROXY_RATE_LIMIT_MAX=100
FIRECRAWL_PROXY_LOG_LEVEL=info
FIRECRAWL_PROXY_URL=http://localhost:3600
FIRECRAWL_PROXY_TEST_URL=http://localhost:3600

FIRECRAWL_PORT=3002
FIRECRAWL_INTERNAL_PORT=3002
FIRECRAWL_HOST=0.0.0.0
FIRECRAWL_BULL_AUTH_KEY=change_me_firecrawl
FIRECRAWL_USE_DB_AUTHENTICATION=false
FIRECRAWL_TEST_API_KEY=change_me_firecrawl
FIRECRAWL_EXTRACT_WORKER_PORT=3004
FIRECRAWL_WORKER_PORT=3005
FIRECRAWL_REDIS_URL=redis://firecrawl-redis:6379
FIRECRAWL_PLAYWRIGHT_URL=http://firecrawl-playwright:3000/scrape
FIRECRAWL_BLOCK_MEDIA=false
FIRECRAWL_LOGGING_LEVEL=info
FIRECRAWL_ALLOW_LOCAL_WEBHOOKS=true
FIRECRAWL_SUPABASE_URL=https://supabase.tradingsystem.local
FIRECRAWL_SUPABASE_ANON_TOKEN=change_me_firecrawl
FIRECRAWL_SUPABASE_SERVICE_TOKEN=change_me_firecrawl
FIRECRAWL_POSTHOG_API_KEY=change_me_firecrawl
FIRECRAWL_POSTHOG_HOST=https://app.posthog.com
FIRECRAWL_SERPER_API_KEY=change_me_firecrawl
FIRECRAWL_SEARCHAPI_API_KEY=change_me_firecrawl

# ==============================================================================
# üé® FRONTEND / DASHBOARD (Vite)
# ==============================================================================
VITE_USE_UNIFIED_DOMAIN=false
VITE_API_BASE_URL=http://localhost:3401
VITE_API_URL=http://localhost:4010
VITE_WS_URL=ws://localhost:4010
VITE_QUESTDB_URL=http://localhost:9002
VITE_PROMETHEUS_URL=http://localhost:9090
VITE_ENABLE_ML_FEATURES=true
VITE_ENABLE_PROFITDLL=false
VITE_TP_CAPITAL_API_URL=http://localhost:4005

# Optional dashboard overrides (dev proxy targets)
VITE_DASHBOARD_PORT=3103
VITE_WORKSPACE_PROXY_TARGET=http://localhost:3102/api
VITE_TP_CAPITAL_PROXY_TARGET=http://localhost:4005
VITE_DOCUMENTATION_PROXY_TARGET=http://localhost:3401
VITE_SERVICE_LAUNCHER_PROXY_TARGET=http://localhost:3500
VITE_FIRECRAWL_PROXY_TARGET=http://localhost:3600
VITE_DOCUSAURUS_PROXY_TARGET=http://localhost:3400
VITE_MCP_PROXY_TARGET=http://localhost:3847
VITE_AGNO_AGENTS_URL=http://localhost:8201

# ==============================================================================
# üîå MCP DEFAULTS (Project-scoped templates)
# ==============================================================================
MCP_FS_ROOT=/home/marce/Projetos/TradingSystem
MCP_GITHUB_REPO=marceloterra1983/TradingSystem
MCP_GITHUB_ORG=
COMPOSE_PROJECT_NAME=tradingsystem
DOCKER_HOST=
MCP_POSTGRES_URL=postgres://frontend_ro:change_me_ro@localhost:5433/trading
FRONTEND_APPS_DB_READONLY_USER=frontend_ro
FRONTEND_APPS_DB_READONLY_PASS=change_me_ro
MCP_OPENAPI_SPECS=docs/static/specs/workspace.openapi.yaml,docs/static/specs/documentation-api.openapi.yaml,docs/static/specs/tp-capital.openapi.yaml

# ==============================================================================
# üì° TELEGRAM (TP Capital)
# ==============================================================================
TELEGRAM_INGESTION_BOT_TOKEN=change_me_telegram_ingestion
TELEGRAM_FORWARDER_BOT_TOKEN=change_me_telegram_forwarder
TELEGRAM_SOURCE_CHANNEL_IDS=-1001649127710
TELEGRAM_DESTINATION_CHANNEL_ID=-1003158967612
TELEGRAM_MODE=polling
TELEGRAM_WEBHOOK_URL=
TELEGRAM_WEBHOOK_SECRET=
QUESTDB_HOST=data-questdb
QUESTDB_HTTP_PORT=9002
QUESTDB_ILP_PORT=9010
QUESTDB_USER=admin
QUESTDB_PASSWORD=change_me_questdb
PORT=3200
LOG_LEVEL=info

# ==============================================================================
# ü§ñ AI & ML TOOLS
# ==============================================================================
OPENAI_API_KEY=change_me_openai
OPENAI_MODEL=gpt-3.5-turbo
QDRANT_API_KEY=change_me_qdrant
QDRANT_HOST=localhost
QDRANT_GRPC_PORT=6334
QDRANT_HTTPS_ENABLED=false
LANGGRAPH_ENV=production
LANGSMITH_API_KEY=change_me_langsmith
LANGSMITH_TRACING=true
LANGSMITH_PROJECT=langgraph-dev
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60
LOG_LEVEL=INFO
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
MAX_CHUNK_SIZE=512
CHUNK_OVERLAP=50
EMBEDDING_MODEL=text-embedding-ada-002
CACHE_TYPE=memory
DOCS_AGENT_MODEL=llama3.1:8b
DOCS_AGENT_MAX_CONTEXT=20000
CACHE_TTL=3600

# LlamaIndex Query Service JWT (Frontend)
# Token gerado com JWT_SECRET_KEY do container (dev-secret)
# V√°lido por 1 ano para desenvolvimento
VITE_LLAMAINDEX_JWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkYXNoYm9hcmQiLCJleHAiOjE3OTMyNDU1NjR9.XbMb7jduH5DP3ErWodUZ7AWSn0l02aKGr1_BTbH1vgs

# ==============================================================================
# üìä MONITORING (Prometheus / Grafana / Alertmanager)
# ==============================================================================
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me_grafana
SLACK_WEBHOOK_URL=change_me_slack
GITHUB_TOKEN=change_me_github
GITHUB_OWNER=marceloterra
GITHUB_REPO=TradingSystem
LOG_LEVEL_MONITORING=info

# ==============================================================================
# üîí SECURITY & CORS (GLOBAL)
# ==============================================================================
CORS_ORIGIN=http://localhost:3103,http://localhost:3400,http://localhost:3401
# Mant√©m alinhado com os containers LlamaIndex (tools/compose/docker-compose.rag.yml)
JWT_SECRET_KEY=dev-secret
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=120

# ==============================================================================
# üîß DOCKER & INFRA
# ==============================================================================

# Standard images for infra stacks (override in .env.local if needed)
IMG_DATA_TIMESCALEDB=timescale/timescaledb
IMG_DATA_TIMESCALEDB_BACKUP=timescale/timescaledb
IMG_DATA_TIMESCALEDB_EXPORTER=prometheuscommunity/postgres-exporter
IMG_DATA_TIMESCALEDB_PGADMIN=dpage/pgadmin4
IMG_DATA_TIMESCALEDB_PGWEB=sosedoff/pgweb
IMG_DATA_TIMESCALEDB_ADMINER=adminer
IMG_DATA_TIMESCALEDB_AZIMUTT=azimutt/azimutt
IMG_DATA_QDRANT=qdrant/qdrant
IMG_DATA_QUESTDB=questdb/questdb

# Image tags (decoupled from IMG_VERSION to avoid invalid combos)
IMG_TIMESCALE_TAG=latest-pg16
IMG_EXPORTER_TAG=latest
IMG_PGADMIN_TAG=latest
IMG_PGWEB_TAG=latest
IMG_ADMINER_TAG=latest
IMG_AZIMUTT_TAG=latest
IMG_POSTGRES_TAG=15
IMG_QDRANT_TAG=latest
IMG_QUESTDB_TAG=latest

# App images
IMG_APPS_TP_CAPITAL=img-apps-tp-capital
IMG_APPS_WORKSPACE=img-apps-workspace

# Infrastructure images
IMG_TOOLS_LANGGRAPH=img-infra-langgraph
IMG_TOOLS_LLAMAINDEX_INGESTION=img-tools-llamaindex-ingestion
IMG_TOOLS_LLAMAINDEX_QUERY=img-tools-llamaindex-query
IMG_TOOLS_AGNO_AGENTS=img-infra-agno-agents

# Vectors (Hybrid search)
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION=documentation
OLLAMA_BASE_URL=http://localhost:11434
LLAMAINDEX_QUERY_URL=http://localhost:8202
LLAMAINDEX_INGESTION_URL=http://localhost:8201
OLLAMA_EMBEDDING_MODEL=nomic-embed-text
OLLAMA_MODEL=llama3

# GPU coordination defaults (serialize GPU workloads across services)
LLAMAINDEX_FORCE_GPU=true
LLAMAINDEX_GPU_NUM=1
LLAMAINDEX_GPU_MAX_CONCURRENCY=1
LLAMAINDEX_GPU_COOLDOWN_SECONDS=0
LLAMAINDEX_GPU_WAIT_LOG_THRESHOLD=0.5
LLAMAINDEX_GPU_USE_FILE_LOCK=true
LLAMAINDEX_GPU_LOCK_PATH=/tmp/llamaindex-gpu.lock
LLAMAINDEX_GPU_LOCK_POLL_SECONDS=0.25

# COMPOSE_PROJECT_NAME=tradingsystem
# DOCKER_NETWORK_SUBNET=172.20.0.0/16

# ==============================================================================
# üíæ REDIS CACHE
# ==============================================================================
REDIS_CACHE_URL=redis://localhost:6379
REDIS_CACHE_DB=0
REDIS_CACHE_PASSWORD=change_me_redis
REDIS_CACHE_SSL=false
REDIS_CACHE_TTL=3600


# ==============================================================================
# üöÄ SERVICE LAUNCHER CONFIGURATION
# ==============================================================================
SERVICE_LAUNCHER_USE_WT=false
SERVICE_LAUNCHER_PROTOCOL=http
SERVICE_LAUNCHER_HOST=localhost
SERVICE_LAUNCHER_TIMEOUT_MS=2500
SERVICE_LAUNCHER_WORKSPACE_PORT=3200
SERVICE_LAUNCHER_TP_CAPITAL_PORT=4005
SERVICE_LAUNCHER_DASHBOARD_PORT=3103
SERVICE_LAUNCHER_DOCUSAURUS_PORT=3400
SERVICE_LAUNCHER_TELEGRAM_GATEWAY_PORT=4006
SERVICE_LAUNCHER_TELEGRAM_GATEWAY_API_PORT=4010
SERVICE_LAUNCHER_TELEGRAM_GATEWAY_URL=http://localhost:4006
SERVICE_LAUNCHER_TELEGRAM_GATEWAY_API_URL=http://localhost:4010

# Telegram Gateway API Database (schema: telegram_gateway on shared TimescaleDB)
# For local development (outside Docker): use localhost:5433
# For Docker container: docker-compose.yml overrides to data-timescaledb:5432
TELEGRAM_GATEWAY_DB_URL=postgresql://timescale:pass_timescale@localhost:5433/tradingsystem?schema=telegram_gateway

TELEGRAM_GATEWAY_FAILURE_QUEUE_PATH=apps/telegram-gateway/data/failure-queue.jsonl
TELEGRAM_GATEWAY_SESSION_FILE=apps/telegram-gateway/.session/telegram-gateway.session
TELEGRAM_GATEWAY_CACHE_TTL_MS=5000
TELEGRAM_GATEWAY_QUEUE_PREVIEW_LIMIT=10
TELEGRAM_GATEWAY_RECENT_MESSAGES_LIMIT=20
TELEGRAM_GATEWAY_CHANNEL_CACHE_TTL_MS=60000
TELEGRAM_GATEWAY_AUTH_LOG_LIMIT=200
VITE_TELEGRAM_GATEWAY_API_URL=http://localhost:4010

# Service Launcher - Additional Configuration
SERVICE_LAUNCHER_CORS_ORIGIN=http://localhost:3103,http://localhost:3400,http://localhost:3401
SERVICE_LAUNCHER_RATE_LIMIT_WINDOW_MS=60000
SERVICE_LAUNCHER_RATE_LIMIT_MAX=200

# ==============================================================================
# üîê SECURITY NOTES (informativo)
# ==============================================================================
#   openssl rand -base64 32  -> senhas fortes
#   openssl rand -hex 32      -> JWT
#   openssl rand -hex 16      -> API keys
# Altere todas as credenciais padr√£o antes de produ√ß√£o.

# Container image repositories live in config/container-images.env
# and are sourced by the stack scripts. Override IMG_VERSION or
# individual IMG_* variables in .env.local when needed.
