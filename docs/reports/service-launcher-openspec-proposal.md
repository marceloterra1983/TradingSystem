---
title: Service Launcher - Proposta OpenSpec Completa
date: 2025-10-18
author: AI Assistant
tags: [service-launcher, openspec, proposal, fix, refactoring]
status: ready-for-review
related_docs:
  - docs/reports/service-launcher-audit-plan.md
  - infrastructure/openspec/changes/fix-service-launcher-critical-issues/
---

# üöÄ Service Launcher - Proposta OpenSpec Completa

## üìã Vis√£o Geral

Esta proposta OpenSpec implementa todas as corre√ß√µes e melhorias identificadas no **[Service Launcher Audit Plan](./service-launcher-audit-plan.md)** usando o formato estruturado OpenSpec do projeto.

### ‚úÖ Status da Proposta
- **Change ID**: `fix-service-launcher-critical-issues`
- **Localiza√ß√£o**: `infrastructure/openspec/changes/fix-service-launcher-critical-issues/`
- **Status**: ‚úÖ Pronta para revis√£o
- **Formato**: OpenSpec compliant

---

## üìä Estat√≠sticas da Proposta

### Conte√∫do Criado
- **Total de linhas**: ~715 linhas
- **Arquivos criados**: 4 arquivos estruturados
- **Requirements**: 13 requirements funcionais
- **Scenarios**: 30 cen√°rios de teste
- **Tasks**: 8 fases de implementa√ß√£o (~60 subtasks)

### Estrutura OpenSpec
```
infrastructure/openspec/changes/fix-service-launcher-critical-issues/
‚îú‚îÄ‚îÄ proposal.md          # Por qu√™, o qu√™, impacto, rollout
‚îú‚îÄ‚îÄ design.md            # Decis√µes t√©cnicas, trade-offs, migra√ß√£o
‚îú‚îÄ‚îÄ tasks.md             # 8 fases de implementa√ß√£o detalhadas
‚îî‚îÄ‚îÄ specs/
    ‚îî‚îÄ‚îÄ service-launcher/
        ‚îî‚îÄ‚îÄ spec.md      # 13 requirements + 30 scenarios
```

---

## üéØ Mapeamento: Audit Plan ‚Üí OpenSpec

### P0 - Problemas Cr√≠ticos

| # | Audit Plan | OpenSpec Requirement | Scenarios |
|---|------------|----------------------|-----------|
| 1 | Conflito de portas 9999 vs 3500 | `Service Launcher Port Configuration` | 3 scenarios |
| 2 | Carregamento .env incorreto | `Centralized Environment Configuration` | 2 scenarios |
| 3 | Portas de servi√ßos incorretas | `Service Port Configuration Accuracy` | 2 scenarios |

**Tasks OpenSpec**: Section 1 (1.1-1.6) - ~2.5h

### P1 - Problemas Graves

| # | Audit Plan | OpenSpec Requirement | Scenarios |
|---|------------|----------------------|-----------|
| 4 | Typo "Laucher" ‚Üí "Launcher" | `Consistent Naming` | 3 scenarios |
| 5 | Falta vari√°veis .env | `Environment Variables Documentation` | 2 scenarios |

**Tasks OpenSpec**: Sections 2-3 (2.1-3.6) - ~3-4h

### P2 - Melhorias Importantes

| # | Audit Plan | OpenSpec Requirement | Scenarios |
|---|------------|----------------------|-----------|
| 6 | Logs inconsistentes | `Structured Logging` | 3 scenarios |
| 7 | Falta testes | `Test Coverage` | 3 scenarios |
| 8 | Documenta√ß√£o fragmentada | `Documentation Standards Compliance` | 2 scenarios |

**Tasks OpenSpec**: Sections 4-6 (4.1-6.11) - ~10-14h

### Funcionalidades Core

| Funcionalidade | OpenSpec Requirement | Scenarios |
|----------------|----------------------|-----------|
| Health check b√°sico | `Health Check API` | 1 scenario |
| Status agregado | `Aggregated Service Status API` | 3 scenarios |
| Launch de servi√ßos | `Service Launch API` | 2 scenarios |
| CORS | `CORS Configuration` | 2 scenarios |
| Rate limiting | `Rate Limiting` | 2 scenarios |

---

## üìñ Documentos da Proposta

### 1. proposal.md
**Conte√∫do**: Por qu√™, o qu√™ mudou, impacto, rollout
- ‚úÖ Justificativa clara dos problemas
- ‚úÖ Lista de mudan√ßas com marca√ß√£o de breaking changes
- ‚úÖ Impacto em c√≥digo e specs
- ‚úÖ Plano de rollout em 3 fases
- ‚úÖ Guia de migra√ß√£o para porta 9999 ‚Üí 3500

**Leia**: [`infrastructure/openspec/changes/fix-service-launcher-critical-issues/proposal.md`](/infrastructure/openspec/changes/fix-service-launcher-critical-issues/proposal.md)

### 2. design.md (~400 linhas)
**Conte√∫do**: Decis√µes t√©cnicas detalhadas
- ‚úÖ Contexto completo do problema
- ‚úÖ Goals vs Non-Goals claramente definidos
- ‚úÖ 5 decis√µes t√©cnicas principais:
  - Porta default 3500 com rationale
  - Carregamento .env do root
  - Logging estruturado com Pino
  - Suite de testes com coverage
  - Documenta√ß√£o reestruturada
- ‚úÖ An√°lise de riscos e mitiga√ß√µes
- ‚úÖ Plano de migra√ß√£o em 3 fases
- ‚úÖ 4 Open Questions documentadas

**Leia**: [`infrastructure/openspec/changes/fix-service-launcher-critical-issues/design.md`](/infrastructure/openspec/changes/fix-service-launcher-critical-issues/design.md)

### 3. tasks.md (~200 linhas)
**Conte√∫do**: Implementa√ß√£o passo a passo
- ‚úÖ **8 se√ß√µes principais**:
  1. Critical Port Fixes (P0) - ~2.5h
  2. Typo Correction (P1) - ~2-3h
  3. Environment Variables (P1) - ~1h
  4. Structured Logging (P2) - ~2h
  5. Test Suite (P2) - ~4-6h
  6. Documentation (P2) - ~4-6h
  7. Validation (All phases)
  8. Deployment & Monitoring

- ‚úÖ **~60 subtasks** com checkboxes
- ‚úÖ Estimativas de tempo por se√ß√£o
- ‚úÖ Ordem de execu√ß√£o claramente definida
- ‚úÖ Valida√ß√µes ap√≥s cada fase

**Leia**: [`infrastructure/openspec/changes/fix-service-launcher-critical-issues/tasks.md`](/infrastructure/openspec/changes/fix-service-launcher-critical-issues/tasks.md)

### 4. specs/service-launcher/spec.md (~450 linhas)
**Conte√∫do**: Requirements formais com scenarios
- ‚úÖ **13 Requirements funcionais**:
  - Service Launcher Port Configuration
  - Centralized Environment Configuration
  - Service Port Configuration Accuracy
  - Structured Logging
  - Health Check API
  - Aggregated Service Status API
  - Service Launch API
  - Environment Variables Documentation
  - Test Coverage
  - Documentation Standards Compliance
  - Consistent Naming
  - CORS Configuration
  - Rate Limiting

- ‚úÖ **30 Scenarios de teste**:
  - Cada requirement tem 1-3 scenarios
  - Formato WHEN/THEN/AND
  - Cobertura de success, error e edge cases

**Leia**: [`infrastructure/openspec/changes/fix-service-launcher-critical-issues/specs/service-launcher/spec.md`](/infrastructure/openspec/changes/fix-service-launcher-critical-issues/specs/service-launcher/spec.md)

---

## üîç Destaques da Proposta

### ‚ú® Pontos Fortes

1. **Estruturada e Completa**
   - Segue rigorosamente formato OpenSpec
   - 715 linhas de documenta√ß√£o detalhada
   - 13 requirements + 30 scenarios test√°veis

2. **Priorizada e Estimada**
   - P0 (2.5h) ‚Üí P1 (3-4h) ‚Üí P2 (10-14h)
   - Total: 15.5-20.5 horas
   - MVP poss√≠vel com apenas P0+P1 (5.5-6.5h)

3. **Decis√µes T√©cnicas Documentadas**
   - 5 decis√µes principais com rationale
   - Alternatives considered para cada uma
   - Risks/mitigations identificados
   - Open questions documentadas

4. **Plano de Migra√ß√£o Detalhado**
   - 3 fases de deploy
   - Rollback strategies
   - Validation checkpoints
   - Monitoring requirements

5. **Test√°vel e Verific√°vel**
   - 30 scenarios cobrem success + error + edge cases
   - Validation steps ap√≥s cada fase
   - Coverage target de 80%+
   - CI/CD integration ready

### üé® Qualidade da Documenta√ß√£o

**Formato OpenSpec Compliant:**
- ‚úÖ `## ADDED Requirements` (n√£o MODIFIED/REMOVED - novo capability)
- ‚úÖ `#### Scenario:` formato correto (4 hashtags)
- ‚úÖ WHEN/THEN/AND structure
- ‚úÖ SHALL/MUST para requirements normativos

**Alinhamento com Projeto:**
- ‚úÖ Segue CLAUDE.md (standards do projeto)
- ‚úÖ Referencia DOCUMENTATION-STANDARD.md
- ‚úÖ Usa ferramentas do projeto (Pino, Jest, PlantUML)
- ‚úÖ Mant√©m consist√™ncia com outros servi√ßos

---

## üöÄ Pr√≥ximos Passos

### 1. Revis√£o da Proposta
- [ ] Revisar `proposal.md` - entender o why/what/impact
- [ ] Revisar `design.md` - validar decis√µes t√©cnicas
- [ ] Revisar `tasks.md` - confirmar ordem e estimativas
- [ ] Revisar `spec.md` - validar requirements e scenarios

### 2. Aprova√ß√£o
- [ ] Discutir breaking changes (porta 9999 ‚Üí 3500)
- [ ] Confirmar timeline (MVP vs Full quality)
- [ ] Aprovar tecnologias (Pino para logs, Jest para testes)
- [ ] Aprovar prioridades (P0 > P1 > P2)

### 3. Implementa√ß√£o
**Op√ß√£o A: MVP R√°pido (5.5-6.5h)**
```bash
# Fazer apenas P0 + P1
cd infrastructure/openspec/changes/fix-service-launcher-critical-issues
# Seguir tasks.md sections 1-3
```

**Op√ß√£o B: Qualidade Completa (15.5-20.5h)**
```bash
# Fazer P0 + P1 + P2
cd infrastructure/openspec/changes/fix-service-launcher-critical-issues
# Seguir tasks.md sections 1-6
```

**Op√ß√£o C: Incremental**
```bash
# Week 1: P0 (sistema funciona)
# Week 2: P1 (consist√™ncia profissional)
# Week 3: P2 (qualidade enterprise)
```

### 4. Valida√ß√£o OpenSpec
```bash
# Ap√≥s aprova√ß√£o, validar formalmente
cd infrastructure/openspec
openspec validate fix-service-launcher-critical-issues --strict
```

### 5. Implementa√ß√£o e Tracking
```bash
# Marcar tasks como completas em tasks.md
# Fazer commits incrementais
# Testar ap√≥s cada se√ß√£o
# Deploy em fases (test ‚Üí staging ‚Üí prod)
```

---

## üìö Refer√™ncias Cruzadas

### Documentos Relacionados
- **[Service Launcher Audit Plan](./service-launcher-audit-plan.md)** - An√°lise completa original (11 problemas identificados)
- **[CLAUDE.md](../../CLAUDE.md)** - Padr√µes do projeto TradingSystem
- **[DOCUMENTATION-STANDARD.md](../DOCUMENTATION-STANDARD.md)** - Formato de documenta√ß√£o oficial
- **[OpenSpec AGENTS.md](../../infrastructure/openspec/AGENTS.md)** - Guia OpenSpec completo

### C√≥digo Afetado
- `frontend/apps/service-launcher/server.js` - Main logic
- `frontend/apps/service-launcher/README.md` - Service docs
- `docs/context/backend/api/service-launcher/README.md` - API reference
- `scripts/startup/start-service-launcher.{sh,ps1}` - Startup scripts
- ~90 arquivos com typo "Laucher"

### Changes Relacionados
- `add-service-launcher-health-summary` - Adiciona m√©tricas agregadas (complementar)

---

## üí° Recomenda√ß√µes

### Para Desenvolvimento R√°pido
Se voc√™ quer o **sistema funcionando rapidamente**:
1. ‚úÖ Implemente apenas **P0** (tasks section 1)
2. ‚úÖ Deploy e valide integra√ß√£o com Dashboard
3. ‚è∞ P1 e P2 podem ser feitos incrementalmente depois

**Resultado**: 2.5 horas ‚Üí Sistema funcional

### Para Qualidade Profissional
Se voc√™ quer **consist√™ncia e configurabilidade**:
1. ‚úÖ Implemente **P0 + P1** (tasks sections 1-3)
2. ‚úÖ Sistema funciona + typo corrigido + .env documentado
3. ‚è∞ P2 (testes, logs, docs) pode ser backlog

**Resultado**: 5.5-6.5 horas ‚Üí Sistema consistente e profissional

### Para Qualidade Enterprise
Se voc√™ quer **manutenibilidade de longo prazo**:
1. ‚úÖ Implemente **P0 + P1 + P2** completo
2. ‚úÖ Testes automatizados (80%+ coverage)
3. ‚úÖ Logging estruturado
4. ‚úÖ Documenta√ß√£o completa com diagramas

**Resultado**: 15.5-20.5 horas ‚Üí Sistema enterprise-grade

---

## ‚úÖ Checklist de Aprova√ß√£o

Antes de iniciar implementa√ß√£o:
- [ ] Proposta revisada e aprovada
- [ ] Breaking changes discutidos e aceitos
- [ ] Timeline acordado (MVP vs Full)
- [ ] Prioridades confirmadas (P0 > P1 > P2)
- [ ] Decis√µes t√©cnicas validadas
- [ ] Riscos entendidos e mitiga√ß√µes aprovadas
- [ ] Plano de migra√ß√£o aceito

---

## üìû Contato

**D√∫vidas sobre a proposta?**
- Revisar: `infrastructure/openspec/changes/fix-service-launcher-critical-issues/`
- Consultar: [OpenSpec AGENTS.md](../../infrastructure/openspec/AGENTS.md)
- Referir ao: [Audit Plan original](./service-launcher-audit-plan.md)

---

**Status**: üìù Aguardando aprova√ß√£o para iniciar implementa√ß√£o

**√öltima atualiza√ß√£o**: 2025-10-18













