---
title: Agno Agents Overview
description: Overview of autonomous agents supporting the Order Manager workflow.
tags:
  - agents
  - order-manager
owner: MCPGuild
lastReviewed: '2025-10-26'
---
## Summary

The **Agno Agents** service is a Python 3.12 microservice using the [Agno framework](https://github.com/agno-agi/agno) and FastAPI to execute a multi-agent trading system composed of three specialized agents:

1. **MarketAnalysisAgent** - Analyzes TP Capital signals and Workspace ideas to generate BUY/SELL/HOLD recommendations
2. **RiskManagementAgent** - Validates each recommendation against daily limits, maximum position size, and trading hours
3. **SignalOrchestratorAgent** - Coordinates flow between agents, aggregates responses, and exposes REST endpoints

**Technology Stack**:
- Python 3.12 + FastAPI
- Agno framework for agent orchestration
- OpenAI GPT-4o for LLM-powered analysis (optional)
- Prometheus for metrics
- Docker for containerized deployment

**Port**: 8200

**Architecture**: Clean Architecture (domain/application/infrastructure/interfaces)

**Integration**: Consumes Workspace API (port 3100) e TP Capital API (port 3200)

## Agent Responsibilities

### MarketAnalysisAgent

**Responsibility**: Consolidate market data and signals to generate trading recommendations.

**Internal Tools**:
- `analyze_tp_signals`: Fetch and analyze TP Capital Telegram signals
- `_extract_size_value`: Extract position size from signal metadata

**Input**:
- `symbols`: List of asset symbols (e.g., `"PETR4", "VALE3"`)
- `include_tp_capital`: Boolean flag to include TP Capital signals

**Output**: List of `MarketSignal` entities with:
- `symbol`: Asset identifier
- `signal_type`: BUY | SELL | HOLD
- `confidence`: Float (0.0-1.0)
- `price`: Recommended entry price
- `timestamp`: Signal generation time
- `source`: Signal origin (AGNO, TP_CAPITAL)
- `size`: Position size recommendation
- `metadata`: Additional context (targets, stop loss, etc.)

**LLM Mode**: Uses OpenAI GPT-4o for intelligent analysis (optional, controlled by `AGNO_ENABLE_LLM`)

**Fallback Mode**: Deterministic heuristics when LLM disabled (confidence-based thresholds)

**Source Code**: `tools/agno-agents/src/interfaces/agents/market_analysis.py`

---

### RiskManagementAgent

**Responsibility**: Validate each `MarketSignal` against risk policies.

**Internal Tools**:
- `check_daily_loss_limit`: Verify account hasn't exceeded daily loss limit
- `check_position_size`: Validate position size against symbol-specific limits
- `check_trading_hours`: Ensure current time is within trading hours (9:00-18:00 BRT)

**Input**: `MarketSignal` entity from MarketAnalysisAgent

**Output**: `RiskAssessment` entity with:
- `signal_id`: Unique identifier (symbol + timestamp)
- `risk_level`: LOW | MEDIUM | HIGH
- `approved`: Boolean (true if all checks pass)
- `daily_loss_check`: Boolean result
- `position_size_check`: Boolean result
- `trading_hours_check`: Boolean result
- `reasons`: List of approval/rejection reasons
- `timestamp`: Assessment time

**Risk Check Sequence**:
1. Trading hours validation (fastest check)
2. Daily loss limit check (database query)
3. Position size limit check (database query)
4. Final approval decision (all checks must pass)

**LLM Mode**: Uses OpenAI GPT-4o for risk reasoning (optional)

**Fallback Mode**: Deterministic rule-based validation

**Source Code**: `tools/agno-agents/src/interfaces/agents/risk_management.py`

---

### SignalOrchestratorAgent

**Responsibility**: Coordinate invocations of MarketAnalysisAgent and RiskManagementAgent.

**Input**: `OrchestrationRequest` with:
- `action`: ANALYZE | VALIDATE | ORCHESTRATE
- `data`: Request-specific data (symbols, signals, etc.)

**Output**: `OrchestrationResponse` with:
- `result`: Aggregated signals and assessments
- `agents_involved`: List of agents invoked
- `total_time`: Total processing time (seconds)

**Orchestration Flows**:

**ANALYZE Action**:
1. Invoke MarketAnalysisAgent with symbols
2. Return generated signals
3. Track: MarketAnalysisAgent only

**VALIDATE Action**:
1. Invoke RiskManagementAgent with signals
2. Return risk assessments
3. Track: RiskManagementAgent only

**ORCHESTRATE Action** (full workflow):
1. Invoke MarketAnalysisAgent to generate signals
2. Invoke RiskManagementAgent to validate each signal
3. Return signals + assessments
4. Track: Both agents

**Source Code**: `tools/agno-agents/src/interfaces/agents/signal_orchestrator.py`

## Triggers

### API Endpoints

**POST /api/v1/agents/analyze**:
- **Trigger**: Dashboard or external client requests market analysis
- **Request**: `{ "symbols": ["PETR4"], "include_tp_capital": true, "include_b3": true }`
- **Response**: `{ "signals": [...], "analysis_time": 0.42 }`
- **Agent**: MarketAnalysisAgent only

**POST /api/v1/agents/signals**:
- **Trigger**: Dashboard or external client requests full orchestration
- **Request**: `{ "action": "ORCHESTRATE", "data": { "symbols": ["PETR4"] } }`
- **Response**: `{ "result": {...}, "agents_involved": [...], "total_time": 0.78 }`
- **Agents**: MarketAnalysisAgent + RiskManagementAgent (coordinated by SignalOrchestratorAgent)

**GET /api/v1/agents/status**:
- **Trigger**: Health check or monitoring
- **Response**: `{ "market_analysis": "ready", "risk_management": "ready", "signal_orchestrator": "ready" }`
- **Purpose**: Verify agent initialization status

### Scheduled Triggers (Planned)

**Periodic Analysis** (future):
- Cron job triggers analysis every 15 minutes during market hours
- Generates signals for watchlist symbols
- Stores results in database for dashboard consumption

**Event-Driven Triggers** (future):
- New TP Capital signal → Trigger analysis for mentioned symbol
- Workspace idea created → Trigger analysis for idea symbols

## Interactions with Core Services

### Workspace API (Port 3100)

**Client**: `WorkspaceClient` (`infrastructure/adapters/workspace_client.py`)

**Methods**:
- `ping()`: Health check
- `get_ideas()`: Fetch workspace ideas (trading ideas, feature requests)
- `create_idea()`: Create new idea (future)

**Integration**:
- MarketAnalysisAgent queries ideas to identify symbols of interest
- Combines idea context with market data for richer analysis

**Resilience**: Retry with exponential backoff, circuit breaker (5 failures → open)

---

### TP Capital API (Port 3200)

**Client**: `TPCapitalClient` (`infrastructure/adapters/tp_capital_client.py`)

**Methods**:
- `ping()`: Health check
- `get_tp_capital_signals(limit)`: Fetch recent Telegram signals

**Integration**:
- MarketAnalysisAgent fetches TP Capital signals
- Transforms payload to unified signal format
- Extracts buy ranges, targets, stop loss levels

**Resilience**: Retry with exponential backoff, circuit breaker

### Risk Engine (Planned)

**Client**: `RiskEngineClient` (`infrastructure/adapters/risk_engine_client.py`)

**Methods**:
- `check_daily_limits()`: Verify daily loss limit
- `check_position_size(symbol, size)`: Validate position size
- `check_trading_hours()`: Verify trading hours

**Integration**:
- RiskManagementAgent calls risk engine for validation
- Currently returns mock data (true for all checks)
- Future: Integrate with Order Manager API (port 3205)

**Resilience**: Retry with exponential backoff, circuit breaker

## Performance Characteristics

**Latency Targets**:
- Market analysis: &lt;1s p95 (per guide line 130: `"analysis_time": 0.42`)
- Risk validation: &lt;500ms p95
- Full orchestration: &lt;2s p95 (per guide line 131: `"total_time": 0.78`)

**Throughput**:
- Concurrent requests: 10+ (FastAPI async)
- Symbols per request: 1-10 (optimal)
- Requests per minute: 100+ (rate limited)

**Resource Usage**:
- Memory: 200-500 MB (depends on LLM mode)
- CPU: &lt;20% idle, &lt;80% under load
- Network: 1-10 Mbps (API calls + WebSocket)

## Related Documentation

- [Agent Flows](./flows) - Execution flows and state transitions
- [Agent Prompts](./prompts) - Prompt templates and patterns
- [MCP Integration](./mcp) - MCP capabilities and permissions
- [Agent Tests](./tests) - Test suite and coverage
- [Agno Framework ADR](../../reference/adrs/agno-framework) (when migrated)
- [API Reference](../../api/agno-agents) (when created)
