---
title: MCP Permissions
description: Permission model and governance for MCP tools and agents.
tags:
  - mcp
  - security
owner: MCPGuild
lastReviewed: '2025-10-26'
---
## Permission Levels

MCP servers in TradingSystem operate with granular permissions defined in the `.claude-plugin` configuration.

### Available Scopes

**File Operations**:

- `Read`: Read file contents from allowed directories
- `Write`: Create new files in allowed directories
- `Edit`: Modify existing files
- `Glob`: Pattern-based file search (e.g., `**/*.ts`)
- `Grep`: Text search within files

**Shell Operations**:

- `Bash`: Execute shell commands (with confirmation for destructive operations)
- `BashOutput`: Capture command output
- `KillShell`: Terminate shell processes

**Development Operations**:

- `Task`: Create and manage tasks
- `TodoWrite`: Create TODO items
- `NotebookEdit`: Edit Jupyter notebooks
- `SlashCommand`: Execute custom commands (e.g., `/health-check`, `/git-workflows`)

**External Access**:

- `WebFetch`: Make HTTP requests to external URLs
- `WebSearch`: Perform web searches

**Workflow Control**:

- `ExitPlanMode`: Exit planning mode and execute actions

### Permission Matrix

| MCP Server | Read | Write | Edit | Bash | WebFetch | Notes |
|------------|------|-------|------|------|----------|-------|
| **fs-tradingsystem** | ✅ | ✅ | ✅ | ❌ | ❌ | File operations only |
| **git-tradingsystem** | ✅ | ✅ | ❌ | ✅ | ❌ | Git commands via Bash |
| **fetch** | ❌ | ❌ | ❌ | ❌ | ✅ | HTTP requests only |
| **memory** | ✅ | ✅ | ❌ | ❌ | ❌ | Key-value storage |
| **sequential-thinking** | ❌ | ❌ | ❌ | ❌ | ❌ | Reasoning only |
| **time** | ✅ | ❌ | ❌ | ❌ | ❌ | Read-only time info |
| **everything** | ✅ | ❌ | ❌ | ❌ | ❌ | Search only |

### Allowed Directories

**Permitted Paths**:

- `/home/marce/Projetos/TradingSystem` (full repository access)

**Restricted Paths**:

- System directories (e.g., `/etc`, `/usr`, `/var`)
- Parent directories (e.g., `/home/marce/Projetos/`)
- Hidden files outside project (e.g., `~/.ssh`, `~/.aws`)

**Adding Directories**:

```bash
claude --add-dir /path/to/directory
cat ~/.claude.json | jq '.projects[].allowedDirectories'
```

## Approval Workflows

### Automatic Approval

**Read Operations** (no confirmation required):

- Read file contents
- List directory contents
- Search files (Glob, Grep)
- Git status, log, diff
- Get current time
- Retrieve memory values

**Non-Destructive Writes** (no confirmation required):

- Create new files
- Update existing files (with backup)
- Store memory values
- Execute custom commands (pre-approved)

### Confirmation Required

**Destructive Operations**:

- Delete files
- Force push to Git
- Overwrite files without backup
- Execute system commands (sudo)

**Security-Sensitive Operations**:

- Modify `.env` file
- Update Git configuration
- Change file permissions
- Access credential files

**Multi-File Operations**:

- Batch file updates (&gt;10 files)
- Recursive directory operations
- Mass deletions

**Confirmation Flow**:

1. MCP server requests operation
2. Claude Code CLI prompts user for confirmation
3. User approves or denies
4. Operation executes or aborts
5. Result logged to audit trail

### Escalation Paths

**Level 1: User Confirmation**

- Destructive operations
- Security-sensitive changes
- Multi-file operations

**Level 2: Team Lead Approval**

- Production deployments
- Database migrations
- Architecture changes

**Level 3: Security Review**

- New MCP server integration
- Permission scope expansion
- External API access

**Escalation Contacts**:

- User: Immediate confirmation via CLI prompt
- Team Lead: Slack notification + approval workflow
- Security: Email + formal review process

## Governance

### Review Cadences

**Weekly Reviews**:

- Review MCP operation logs (`~/.claude/debug/`)
- Check for failed operations or errors
- Identify unusual access patterns
- Validate server health (`claude mcp list`)

**Monthly Reviews**:

- Audit MCP server permissions
- Review allowed directories
- Check for unused servers (remove if inactive)
- Update server configurations
- Rotate API tokens (if HTTP transport used)

**Quarterly Reviews**:

- Comprehensive security audit
- Review and update permission scopes
- Evaluate new MCP server integrations
- Update governance policies
- Train team on MCP best practices

### Logging Expectations

**Required Logging**:

- All MCP operations (read, write, execute)
- Operation timestamp, server, user, result
- Error details (stack traces for failures)
- Performance metrics (latency, throughput)

**Log Format**:

```json
{
  "timestamp": "2025-10-24T10:30:45.123Z",
  "level": "INFO",
  "server": "fs-tradingsystem",
  "operation": "read_file",
  "path": "/home/marce/Projetos/TradingSystem/README.md",
  "user": "marce",
  "result": "success",
  "latency_ms": 5
}
```

**Log Storage**:

- Location: `~/.claude/debug/`
- Retention: 30 days
- Rotation: Daily
- Format: JSONL (one JSON object per line)

**Log Analysis**:

```bash
tail -f ~/.claude/debug/mcp-operations.jsonl
cat ~/.claude/debug/mcp-operations.jsonl | jq -r '.server' | sort | uniq -c
cat ~/.claude/debug/mcp-operations.jsonl | jq 'select(.result == "error")'
```

### Audit Requirements

**Audit Trail**:

- All write operations logged
- All destructive operations logged
- All permission denials logged
- All authentication failures logged

**Audit Reports**:

- Weekly: MCP operation summary (counts by server, errors)
- Monthly: Permission usage analysis (identify unused permissions)
- Quarterly: Security audit (review all operations, identify anomalies)

**Compliance**:

- Retain audit logs for 1 year
- Provide audit reports on request
- Support forensic analysis (incident investigation)

### Permission Changes

**Adding New Permissions**:

1. Document justification (why needed)
2. Submit PR with `.claude-plugin` changes
3. Security review (assess risk)
4. Team lead approval
5. Update documentation
6. Deploy and monitor

**Removing Permissions**:

1. Identify unused permissions (audit logs)
2. Verify no active usage (30-day lookback)
3. Submit PR with removal
4. Update documentation
5. Monitor for issues (7-day window)

**Emergency Revocation**:

1. Detect security incident (unauthorized access)
2. Immediately revoke permissions (update `.claude-plugin`)
3. Restart Claude Code CLI
4. Investigate incident
5. Document findings and remediation

## Best Practices

### Principle of Least Privilege

- Grant minimum permissions required for task
- Review permissions quarterly
- Remove unused permissions promptly
- Document permission rationale

### Defense in Depth

- Multiple security layers (file permissions + MCP permissions + allowed directories)
- Audit logging for all operations
- Confirmation for destructive operations
- Rate limiting for external requests

### Secure by Default

- New servers start with read-only permissions
- Write permissions require explicit approval
- External access disabled by default
- Audit logging always enabled

## Related Documentation

- [MCP Registry](./registry) - MCP server catalog
- [MCP Transports](./transports) - Transport protocols
- Claude Code CLI setup (migration pending)
- [Security Configuration](../../tools/security-config/overview)
- [Audit Procedures](../../tools/security-config/audit)
