---
title: Alertmanager Escalation Runbook
description: Procedimento operacional para responder a alertas cr√≠ticos em m√∫ltiplos canais (GitHub, Slack, Email).
tags:
  - observability
  - runbook
  - alertmanager
owner: SRE
lastReviewed: "2025-11-12"
---

# Alertmanager Escalation Runbook

> **Escopo:** alertas gerados pelo stack Prometheus ‚Üí Alertmanager ‚Üí Alert Router com fanout para Slack e e-mail.

## üö® Detec√ß√£o

1. **GitHub Issue** criado automaticamente pelo Alert Router (`trading-alerts` label).
2. **Slack** recebe mensagem no canal `{{ env "ALERTMANAGER_SLACK_CHANNEL" }}`:
   - T√≠tulo: `[STATUS] ALERTNAME`
   - Emoji `:rotating_light:` para `critical`, `:warning:` para `warning`.
3. **Email** enviado para `ALERTMANAGER_EMAIL_TO` com resumo e descri√ß√£o formatados em HTML.

## ‚úÖ Primeira resposta (T+5 minutos)

1. Reconhecer o alerta no Slack com rea√ß√£o ‚úÖ.
2. Atribuir a issue no GitHub para o on-call.
3. Registrar no coment√°rio da issue:
   - Hora do reconhecimento
   - Canal de contato escolhido (Slack huddle / Zoom)

## üîç Investiga√ß√£o

1. Abrir dashboards no Grafana:
   - `TradingSystem Overview`
   - `Logs / Loki Live`
2. Se necess√°rio, rodar query LogQL:

```logql
{job="docker-containers", container=~"workspace-api|telegram-gateway"} |~ "ERROR"
```

3. Validar depend√™ncias (Prometheus targets, status Docker).

## üõ†Ô∏è Mitiga√ß√£o

- **Restart controlado:** `docker compose -f tools/compose/docker-compose.1-dashboard-stack.yml restart <service>`
- **Feature flag:** usar `config/services-manifest.json` se dispon√≠vel.
- **Escalonamento:** se MTTR > 30 min, acionar `ops@tradingsystem.local` e Product Manager.

## üì¶ Encerramento

1. Confirmar resolu√ß√£o ‚Üí Alertmanager envia `resolved`.
2. Alert Router fecha issue automaticamente.
3. Adicionar nota p√≥s-mortem na issue:
   - Causa raiz
   - A√ß√£o corretiva
   - Follow-up (ticket ou ADR)

## üßæ Logs e Artefatos

- Logs brutos: Loki (`http://localhost:3100`)
- Issue GitHub: repos `TradingSystem`
- Email: caixa `ops@tradingsystem.local`

---

**Checklist semanal**

- [ ] Validar vari√°veis `ALERTMANAGER_*` no `.env`.
- [ ] Rodar `docker compose -f tools/monitoring/docker-compose.yml logs alertmanager`.
- [ ] Testar webhook Slack com `amtool alert add`.

