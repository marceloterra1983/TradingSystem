---
title: Data Platform
description: Schemas, retention policies, and operational guidance for TradingSystem
  databases.
tags:
  - database
  - observability
owner: DataOps
lastReviewed: '2025-10-27'
---
## Overview

TradingSystem operates a multi-store data platform with production-grade databases supporting core applications. The architecture successfully migrated from lightweight JSON storage to PostgreSQL/TimescaleDB for transactional workloads while retaining specialized databases for time-series telemetry.

### Current Architecture

- **TimescaleDB (Production)**  
  Primary relational storage for TP Capital API and Workspace services  
  Databases: `APPS-TPCAPITAL`, `APPS-WORKSPACE`  
  Port: 5433 (host) → 5432 (container)  
  Features: ACID transactions, hypertables, concurrent writes, time-series optimizations  
  Status: ✅ Active (production)

- **PostgreSQL + Prisma (Production)**  
  Documentation API database with ORM-managed migrations  
  Database: `documentation-api`  
  Port: 5434 (host) → 5432 (container)  
  Features: Automated schema migrations, type-safe queries, audit logging  
  Status: ✅ Active (production)

- **QuestDB (Production)**  
  Time-series storage for TP Capital signals and Telegram metadata  
  Tables: `tp_capital_signals`, `tp_capital_signals_deleted`, `telegram_bots`, `telegram_channels`  
  Ports: 9002 (HTTP UI), 9009 (ILP ingestion), 8812 (PostgreSQL wire)  
  Features: Append-only ingestion, day partitions, high-throughput writes  
  Status: ✅ Active (production)

- **LowDB (Legacy)**  
  MVP storage for legacy Idea Bank  
  Files: `db/ideas.json`  
  Limitations: No concurrency, no transactions, file-based writes  
  Status: ⚠️ Active (MVP), migration to PostgreSQL planned Q1 2026

- **Parquet Files (Analytics)**  
  Historical market data for analytics and machine learning  
  Location: `data/parquet/`  
  Format: Apache Arrow columnar files with 2+ years retention  
  Status: ✅ Active (analytics workloads)

### Architecture Evolution

**Completed Migrations**:

1. ✅ **Infrastructure** – PostgreSQL 14+ with TimescaleDB extension provisioned
2. ✅ **Database Structure** – Migrated to app-based organization (APPS-TPCAPITAL, APPS-WORKSPACE)
3. ✅ **Documentation API** – Migrated to Prisma ORM with PostgreSQL
4. ✅ **TP Capital API** – Containerized with dedicated TimescaleDB database
5. ✅ **Workspace API** – Containerized with TimescaleDB hypertables

**Pending Migrations**:

- ⏳ **Idea Bank** – Migrate from LowDB to PostgreSQL (Q1 2026)

## Data Stores

### TimescaleDB (Production)

**APPS-TPCAPITAL Database**

- **Purpose**: TP Capital trading signals and Telegram configuration  
- **Schema**: `tp-capital`  
- **Port**: 5433 (host) → 5432 (container)  
- **Connection**: `postgresql://timescale@localhost:5433/APPS-TPCAPITAL`  
- **Tables**:
  - `tp_capital_signals`: Trading signals with hypertable partitioning
  - `telegram_bots`: Bot credentials and configuration
  - `telegram_channels`: Monitored channels registry
- **Features**: TimescaleDB hypertables, automatic partitioning, compression policies  
- **Admin Tools**: PgAdmin (5050), pgWeb (8081)  
- **Backup**: Automated via `scripts/database/backup-timescaledb.sh`

**APPS-WORKSPACE Database**

- **Purpose**: Workspace items and audit logging  
- **Schema**: `workspace`  
- **Port**: 5433 (host) → 5432 (container)  
- **Connection**: `postgresql://timescale@localhost:5433/APPS-WORKSPACE`  
- **Tables**:
  - `workspace_items`: Hypertable with monthly partitioning
  - `workspace_audit_log`: Change tracking with automatic triggers
  - `schema_version`: Migration tracking
- **Features**: Hypertables, audit triggers, JSONB metadata, GIN indexes  
- **Admin Tools**: PgAdmin (5050), pgWeb (8081)  
- **Backup**: Automated via `scripts/database/backup-timescaledb.sh`

### PostgreSQL + Prisma (Production)

**documentation-api Database**

- **Purpose**: Documentation systems, ideas, and file management  
- **Port**: 5434 (host) → 5432 (container)  
- **Connection**: `postgresql://postgres@localhost:5434/documentation-api`  
- **Tables**:
  - `documentation_systems`: System registry with status tracking
  - `documentation_ideas`: Ideas and feature requests
  - `documentation_files`: File uploads with metadata
  - `documentation_audit_log`: Audit trail for all operations
- **Features**: Prisma migrations, type-safe queries, foreign keys, indexes  
- **Migrations**: `backend/api/documentation-api/prisma/migrations/`  
- **Commands**:

  ```bash
  cd backend/api/documentation-api
  npx prisma migrate deploy    # Apply migrations
  npx prisma migrate dev        # Create new migration
  npx prisma studio             # GUI database browser
  ```

### QuestDB (Production)

- **Purpose**: High-throughput time-series storage for TP Capital signals  
- **Ports**: 9002 (HTTP UI), 9009 (ILP ingestion), 8812 (PostgreSQL wire)  
- **Tables**:  
  - `tp_capital_signals`: Normalized Telegram signals, day-partitioned  
  - `tp_capital_signals_deleted`: Soft delete archive for audit recovery  
  - `telegram_bots`: Bot credential store  
  - `telegram_channels`: Monitored channels configuration  
- **Features**: Append-only ILP writes, PostgreSQL wire protocol, web UI  
- **Retention**: 30-day online window with monthly exports to cold storage  
- **Backup**: `scripts/database/restore-questdb.sh`  
- **Web UI**: `http://localhost:9002`

### LowDB (Legacy)

- **Purpose**: Legacy JSON store for Idea Bank (migration pending)  
- **Files**: `db/ideas.json`  
- **Access Pattern**: Entire file load/write, single-user usage  
- **Limitations**: No concurrency control, last-write-wins conflicts  
- **Backup**: Daily snapshots to `backups/lowdb/`  
- **Migration**: Planned Q1 2026 to PostgreSQL

### Parquet Files (Analytics)

- **Purpose**: Long-horizon market data for backtesting and ML  
- **Location**: `data/parquet/` organized by `YYYY/MM/DD`  
- **Format**: Apache Arrow columnar with compression for fast scans  
- **Retention**: Minimum two years of intraday history  
- **Backup**: `robocopy /MIR` (Windows) or `rsync` (Linux) to secondary storage  
- **Access**: Python (Polars, Pandas) and Spark pipelines

## Access Patterns

### TP Capital API (TimescaleDB)

- **Write Path**: Telegram Gateway → HTTP POST → Validation → TimescaleDB INSERT → Confirmation  
- **Read Path**: Dashboard → REST API → SQL queries → JSON responses  
- **Database**: `APPS-TPCAPITAL` on port 5433  
- **Common Queries**:  
  - Recent signals: `SELECT * FROM "tp-capital".tp_capital_signals WHERE created_at > now() - INTERVAL '7 days' ORDER BY created_at DESC LIMIT 100`  
  - Channel filter: `WHERE channel = 'TP_Capital'`  
  - Asset search: `WHERE asset ILIKE '%PETR%'`  
- **Connection Pool**: 10 max connections, 2 min idle

### Workspace API (TimescaleDB)

- **Write Path**: REST API → Validation → TimescaleDB INSERT/UPDATE → Audit trigger → Response  
- **Read Path**: Dashboard → REST API → SQL queries with indexes → JSON responses  
- **Database**: `APPS-WORKSPACE` on port 5433  
- **Common Queries**:  
  - Active items: `SELECT * FROM workspace.workspace_items WHERE status NOT IN ('completed', 'rejected') ORDER BY created_at DESC`  
  - High priority: `WHERE priority IN ('high', 'critical') AND status = 'in-progress'`  
  - Tag search: `WHERE tags @> ARRAY['bug']::text[]`  
- **Features**: Automatic audit logging via triggers, JSONB metadata queries

### Documentation API (PostgreSQL + Prisma)

- **Write Path**: REST API → Prisma Client → PostgreSQL → Response  
- **Read Path**: REST API → Prisma queries → Type-safe results → JSON responses  
- **Database**: `documentation-api` on port 5434  
- **Common Queries**:  
  - Find by status: `prisma.documentation_ideas.findMany({ where: { status: 'backlog' } })`  
  - Include relations: `{ include: { system: true, files: true } }`  
  - Search: `{ where: { title: { contains: 'API' } } }`  
- **Features**: Automated migrations, type-safe queries, relation loading

### QuestDB Signals (Time-Series)

- **Write Path**: Telegram → Parser → Validator → QuestDB ILP → Confirmation  
- **Read Path**: Dashboard → REST API → QuestDB SQL → JSON responses  
- **Ports**: 9009 (ILP), 8812 (PostgreSQL wire)  
- **Common Queries**:  
  - Recent signals: `SELECT * FROM tp_capital_signals WHERE ts > now() - 7d ORDER BY ts DESC LIMIT 100`  
  - Channel filter: `WHERE channel = 'TP_Capital'`  
  - Asset search: `WHERE asset LIKE '%PETR%'`  

### Market Data (Parquet)

- **Write Path**: Data capture → Serializer → Parquet writer → Disk  
- **Read Path**: Python scripts using Polars/Pandas → DataFrame analytics  
- **Usage**: Time-range scans, symbol filters, aggregations for strategy research

### Legacy Idea Bank (LowDB)

- **Current**: Reads/writes entire JSON file with synchronous I/O  
- **Migration**: Planned Q1 2026 to PostgreSQL with proper schema and indexes

## Related Documentation

- [Schema Reference](./schema) – Detailed table definitions across domains.  
- [Migrations](./migrations) – Strategy, checklists, and execution logs.  
- [Retention & Backup](./retention-backup) – Retention windows and backup procedures.  
- Database UI tools and TimescaleDB operations guides migrate separately.
