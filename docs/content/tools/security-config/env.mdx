---
title: Environment Variables Reference
description: Complete reference of all environment variables used in TradingSystem.
tags:
  - tools
  - security
  - environment
  - configuration
owner: SecurityOps
lastReviewed: '2025-10-26'
---
## Overview

TradingSystem uses a **hierarchical environment variable system** with multiple `.env` files loaded in order of precedence. This reference lists every variable, its purpose, default values, and security notes.

## Environment File Hierarchy

The project uses **5 levels** of environment configuration, loaded by [`backend/shared/config/load-env.js`](../../../backend/shared/config/load-env.js):

```javascript
// Load order (precedence: later files override earlier)
1. config/container-images.env  // Docker image names/tags
2. config/.env.defaults         // ✅ VERSIONADO - Defaults do projeto
3. .env                         // ⚠️  NÃO versionado - Config do ambiente
4. .env.local                   // ⚠️  NÃO versionado - Overrides locais
5. service/.env                 // ⚠️  NÃO versionado - Service-specific
```

### File Purposes

| File | Purpose | Versioned (Git) | When to Edit |
|------|---------|-----------------|--------------|
| **`config/.env.defaults`** | Default values for all variables | ✅ Yes | Changing project defaults |
| **`.env`** (root) | Environment-specific configuration | ❌ No (.gitignore) | Setting up local environment |
| **`.env.local`** (root) | Temporary local overrides | ❌ No (.gitignore) | Testing config changes |
| **`service/.env`** | Service-specific overrides | ❌ No (.gitignore) | Service needs different value |
| **`.env.example`** | Template for new developers | ✅ Yes | Adding new required variables |

### Precedence Rules

**Later files override earlier files**:
- `service/.env` overrides everything
- `.env.local` overrides `.env` and `.env.defaults`
- `.env` overrides `.env.defaults`
- `.env.defaults` provides base values

**Example**:
```bash
# config/.env.defaults
PORT=3500

# .env (root)
# (não define PORT, usa default)

# apps/status/.env
RATE_LIMIT_MAX=200  # Override specific value only

# Result: PORT=3500 (from defaults), RATE_LIMIT_MAX=200 (from service)
```

## Quick Reference

- **Defaults**: [`config/.env.defaults`](../../../config/.env.defaults) (333 lines, committed)
- **Your Config**: `.env` (gitignored, copy from `.env.example`)
- **Template**: `.env.example` (committed)
- **Validation**: `bash scripts/env/validate-env.sh`

## Required Variables

| Variable | Description | How to Generate | Example |
|----------|-------------|-----------------|---------|
| `TIMESCALEDB_PASSWORD` | TimescaleDB password | `openssl rand -base64 32` | `xK9mP2vL...` |
| `PGADMIN_DEFAULT_PASSWORD` | PgAdmin admin password | `openssl rand -base64 32` | `aB3nQ7wR...` |
| `GRAFANA_ADMIN_PASSWORD` | Grafana admin password | `openssl rand -base64 32` | `zY5tM8pK...` |
| `OPENAI_API_KEY` | OpenAI API key | `https://platform.openai.com/api-keys` | `sk-proj-...` |
| `JWT_SECRET_KEY` | JWT signing secret | `openssl rand -hex 32` | `a1b2c3d4...` |

## Database Variables

### TimescaleDB

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `TIMESCALEDB_DB` | Database name | `tradingsystem` | No |
| `TIMESCALEDB_USER` | Database user | `timescale` | No |
| `TIMESCALEDB_PASSWORD` | Database password | – | **Yes** |
| `TIMESCALEDB_PORT` | Host port | `5433` | No |
| `TIMESCALEDB_BACKUP_CRON` | Backup schedule | `0 2 * * *` | No |
| `TIMESCALEDB_EXPORTER_PORT` | Prometheus exporter port | `9187` | No |

- **Services**: `docker-compose.timescale.yml`.  
- **Connection String**: `postgresql://${TIMESCALEDB_USER}:${TIMESCALEDB_PASSWORD}@localhost:${TIMESCALEDB_PORT}/${TIMESCALEDB_DB}`.  
- **Security**: Use 32+ character passwords, rotate every 90 days, avoid defaults.

## Admin UI Variables

### PgAdmin

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `PGADMIN_DEFAULT_EMAIL` | Admin email | – | **Yes** |
| `PGADMIN_DEFAULT_PASSWORD` | Admin password | – | **Yes** |
| `PGADMIN_LISTEN_PORT` | Internal port | `5050` | No |
| `PGADMIN_HOST_PORT` | Host port | `5050` | No |

- **Access**: `http://localhost:5050` (localhost only).  
- **Security**: Bind to localhost, place behind reverse proxy with auth for external access, enable 2FA if available.

### Grafana

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `GRAFANA_ADMIN_USER` | Admin username | `admin` | No |
| `GRAFANA_ADMIN_PASSWORD` | Admin password | – | **Yes** |

- **Access**: `http://localhost:3000`.  
- **Stacks**: `monitoring/docker-compose.yml`.

## AI & ML Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `OPENAI_API_KEY` | OpenAI API key for LlamaIndex | – | **Yes** |
| `QDRANT_API_KEY` | Qdrant API key | – | No |
| `RATE_LIMIT_REQUESTS` | Rate limit count | `100` | No |
| `RATE_LIMIT_PERIOD` | Rate limit window (seconds) | `60` | No |
| `LOG_LEVEL` | Logging verbosity | `INFO` | No |
| `LANGGRAPH_ENV` | LangGraph environment | `production` | No |

- **Services**: `docker-compose.infra.yml`.  
- **Security**: Rotate API keys every 180 days, monitor usage, apply least privilege.

## Monitoring Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `SLACK_WEBHOOK_URL` | Slack alerts webhook | – | No |
| `GITHUB_TOKEN` | GitHub PAT for automation | – | No |
| `GITHUB_OWNER` | Repository owner | `marceloterra` | No |
| `GITHUB_REPO` | Repository name | `TradingSystem` | No |

- **Notes**: Use read-only scopes, rotate tokens every 180 days, revoke immediately on compromise.

## Backend API Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `WORKSPACE_PORT` | Workspace API port | `3100` | No |
| `WORKSPACE_TABLE_NAME` | Workspace table | `workspace_items` | No |
| `TP_CAPITAL_PORT` | TP Capital API port | `3200` | No |
| `TELEGRAM_BOT_TOKEN` | Telegram bot token | – | No |
| `TELEGRAM_CHAT_ID` | Telegram chat ID | – | No |
| `QUESTDB_HTTP_URL` | QuestDB URL | `http://localhost:9002` | No |
| `DOCS_API_PORT` | Documentation API port | `3400` | No |
| `SERVICE_LAUNCHER_PORT` | Service Launcher port | `3500` | No |

- **Security**: Protect Telegram tokens, rotate quarterly, validate all API inputs.

## Frontend Variables

### Core URLs

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `VITE_API_URL` | API base URL | `http://localhost:4010` | No |
| `VITE_WS_URL` | WebSocket URL | `ws://localhost:4010` | No |
| `VITE_QUESTDB_URL` | QuestDB URL | `http://localhost:9002` | No |
| `VITE_PROMETHEUS_URL` | Prometheus URL | `http://localhost:9090` | No |

### Proxy Overrides

| Variable | Purpose | Default |
|----------|---------|---------|
| `VITE_DASHBOARD_PORT` | Dev server port | `3103` |
| `VITE_WORKSPACE_PROXY_TARGET` | Workspace proxy target | `http://localhost:3100/api` |
| `VITE_TP_CAPITAL_PROXY_TARGET` | TP Capital proxy target | `http://localhost:3200` |
| `VITE_DOCUMENTATION_PROXY_TARGET` | Documentation proxy | `http://localhost:3400` |
| `VITE_SERVICE_LAUNCHER_PROXY_TARGET` | Service Launcher proxy | `http://localhost:3500` |
| `VITE_FIRECRAWL_PROXY_TARGET` | Firecrawl proxy | `http://localhost:3600` |
| `VITE_DOCUSAURUS_PROXY_TARGET` | Documentation Hub proxy | `http://localhost:3400` |
| `VITE_MCP_PROXY_TARGET` | MCP server proxy | `http://localhost:3847` |

```bash
# Override example for containerized gateway
VITE_WORKSPACE_PROXY_TARGET=http://tradingsystem.local/workspace
VITE_TP_CAPITAL_PROXY_TARGET=http://tradingsystem.local/tp-capital
```

## Security Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `CORS_ORIGIN` | Allowed origins (comma-separated) | `http://localhost:3103,http://localhost:3400,http://localhost:3401` | No |
| `JWT_SECRET_KEY` | JWT signing secret | – | **Yes** |
| `RATE_LIMIT_WINDOW_MS` | Rate limit window (ms) | `60000` | No |
| `RATE_LIMIT_MAX` | Requests per window | `120` | No |

- **Security**: Use strong 64 hex char JWT secrets, rotate annually, scope CORS to production domains.

## Validation

### Validation Script

```bash
bash scripts/env/validate-env.sh
```

- Checks for required variables, placeholder values, file permissions, and optional warnings.

### Docker Compose Validation

```bash
docker compose -f tools/compose/docker-compose.timescale.yml config
docker compose -f tools/compose/docker-compose.infra.yml config
docker compose -f tools/monitoring/docker-compose.yml config
```

- Ensures environment variables interpolate cleanly.

## Secret Generation

- **Passwords (32 chars)**: `openssl rand -base64 32`.  
- **JWT Secrets (64 hex)**: `openssl rand -hex 32`.  
- **API Keys (32 hex)**: `openssl rand -hex 16`.

## Rotation Schedule

| Secret Type | Rotation Frequency | Procedure |
|-------------|-------------------|-----------|
| Database passwords | 90 days | Generate new, update `.env`, restart services |
| Admin UI passwords | 90 days | Generate new, update `.env`, restart services |
| API keys | 180 days | Generate new, update `.env`, revoke old |
| JWT secrets | 365 days | Generate new, update `.env`, invalidate tokens |
| Telegram bot tokens | 90 days | Regenerate via BotFather, update `.env` |

## .env Policy and Best Practices

### ✅ When to Use Service-Specific .env

Create `service/.env` **ONLY** when:

1. **Service-specific authentication tokens** (not shared)
   ```bash
   # ✅ OK: apps/telegram-gateway/.env
   TELEGRAM_API_ID=12345678
   TELEGRAM_API_HASH=abc123...
   ```

2. **Development overrides** for testing
   ```bash
   # ✅ OK: backend/api/workspace/.env
   LOG_LEVEL=debug  # Override default 'info' for debugging
   ```

3. **Environment-dependent URLs** (local vs container)
   ```bash
   # ✅ OK: backend/api/telegram-gateway/.env
   # Use localhost:5433 when running LOCALLY (not in container)
   TELEGRAM_GATEWAY_DB_URL=postgresql://...@localhost:5433/...
   ```

### ❌ When NOT to Use Service-Specific .env

**DO NOT** create service `.env` for:

1. **Shared variables** already in `config/.env.defaults`
   ```bash
   # ❌ WRONG: apps/status/.env
   PORT=3500  # Already in .env.defaults!
   CORS_ORIGIN=http://localhost:3103  # Duplicated!
   ```

2. **Secrets that should be in root .env**
   ```bash
   # ❌ WRONG: service/.env
   TIMESCALEDB_PASSWORD=secret  # Should be in root .env only!
   ```

3. **Configuration that affects multiple services**
   ```bash
   # ❌ WRONG: service/.env
   TIMESCALEDB_HOST=data-timescaledb  # Shared by all services!
   ```

### 📋 Service .env Template

When creating a service `.env`, always include header:

```bash
# ==============================================================================
# [Service Name] - Service-Specific Overrides
# ==============================================================================
# Este arquivo sobrescreve defaults de config/.env.defaults
# Apenas variáveis ESPECÍFICAS deste serviço ou overrides de desenvolvimento
# ==============================================================================

# [Justificativa aqui]
VARIABLE_NAME=value
```

### 🔍 Review Checklist

Before committing changes to `.env.defaults` or creating service `.env`:

- [ ] Variable is not duplicated in multiple files
- [ ] Secrets are in root `.env` (gitignored), not in service `.env`
- [ ] Service `.env` has clear header explaining overrides
- [ ] Updated `.env.example` if adding new required variables
- [ ] Tested load order with `node -e "console.log(process.env.VARIABLE)"`

## Related Documentation

- [Security Overview](./overview).
- [Risk Limits](./risk-limits).
- [Security Audit Procedures](./audit).
- [Environment Loader Implementation](../../../backend/shared/config/load-env.js)
- Environment configuration narrative now lives in `docs/content/ops/`.
