---
title: Vulnerability Remediation Guide
sidebar_position: 4
tags: [security, vulnerabilities, remediation]
domain: tools
type: guide
summary: Step-by-step guide for identifying and fixing security vulnerabilities
status: active
last_review: "2025-11-11"
---

# ðŸ”§ Vulnerability Remediation Guide

**Complete guide for responding to and fixing security vulnerabilities - Part of Phase 1.3**

## ðŸ“‹ Overview

This guide provides systematic procedures for identifying, prioritizing, and remediating security vulnerabilities detected by automated security audits.

## ðŸŽ¯ Response Timeline

| Severity | Response Time | Patch Timeline | Deployment |
|----------|---------------|----------------|------------|
| **Critical** | < 2 hours | < 24 hours | Immediately |
| **High** | < 4 hours | < 48 hours | ASAP |
| **Moderate** | < 24 hours | < 1 week | Next release |
| **Low** | < 1 week | < 2 weeks | Scheduled |

## ðŸš¨ Critical Vulnerability Response

### When You Receive the Alert

**GitHub Security Alert Example:**
```
ðŸ”´ CRITICAL VULNERABILITY DETECTED

Package: axios
Severity: Critical (CVSS 9.8)
CVE: CVE-2024-XXXXX
Affected Versions: < 1.6.7
Fixed In: 1.6.7

Description: Remote Code Execution via request interception
```

### Immediate Actions (< 2 hours)

```bash
# 1. Acknowledge the alert
# GitHub â†’ Security â†’ Dependabot alerts â†’ Mark as "In Progress"

# 2. Assess impact
echo "Checking affected projects..."
cd /home/marce/Projetos/TradingSystem

# Find all instances of vulnerable package
find . -name "package.json" -exec grep -l "axios" {} \;

# Output:
# ./frontend/dashboard/package.json
# ./backend/api/workspace/package.json
# ./apps/tp-capital/package.json

# 3. Check current versions
cd frontend/dashboard && npm list axios
cd backend/api/workspace && npm list axios
cd apps/tp-capital && npm list axios

# 4. Verify exploit feasibility
# - Is vulnerable code path reachable?
# - Are attack prerequisites met?
# - Is service exposed to untrusted input?
```

### Remediation Steps (< 24 hours)

```bash
# Option 1: Automatic fix (PREFERRED)
cd frontend/dashboard
npm audit fix

# Option 2: Manual update if auto-fix fails
npm update axios@latest

# Option 3: Force update (if dependencies block update)
npm install axios@1.6.7

# 4. Verify fix
npm audit | grep axios
# Should show: 0 vulnerabilities

# 5. Test application
npm run test
npm run build

# 6. Start locally and verify functionality
npm run dev
# Test affected features

# 7. Commit and push
git add package.json package-lock.json
git commit -m "fix(security): update axios to 1.6.7 (CVE-2024-XXXXX)"
git push origin security/fix-axios-cve
```

### Deployment (Immediate)

```bash
# 1. Create PR
gh pr create \
  --title "fix(security): Critical - Update axios (CVE-2024-XXXXX)" \
  --body "**Severity:** Critical (CVSS 9.8)
**CVE:** CVE-2024-XXXXX
**Package:** axios < 1.6.7
**Fix:** Update to axios@1.6.7

**Testing:**
- [x] Tests pass
- [x] Build succeeds
- [x] Local testing completed
- [x] No breaking changes detected

**Impact:**
- Remote Code Execution vulnerability
- Affects frontend, workspace-api, tp-capital
- No exploitation detected in logs

**Deployment:** Merge and deploy immediately" \
  --label "security,critical,automated"

# 2. Merge immediately after CI passes
gh pr merge --squash --auto

# 3. Deploy to production
# (Follow your deployment process)

# 4. Verify fix in production
curl -I https://your-production-url.com
# Check response headers for updated version

# 5. Close security alert
# GitHub â†’ Security â†’ Dependabot alerts â†’ Mark as "Fixed"
```

## ðŸŸ  High Vulnerability Response

### Assessment (< 4 hours)

```bash
# 1. Review vulnerability details
# GitHub Security tab â†’ Review CVE details

# 2. Check exploit complexity
# - High/Low complexity?
# - Authentication required?
# - User interaction needed?

# 3. Assess business impact
# - What functionality is affected?
# - How many users impacted?
# - Data exposure risk?
```

### Remediation (< 48 hours)

```bash
# Follow similar process to Critical, but with testing:

# 1. Update package
npm audit fix

# 2. Run full test suite
npm run test
npm run test:e2e
npm run test:integration

# 3. Check for breaking changes
npm run build
# Review build output for warnings

# 4. Test locally
npm run dev
# Manual testing of affected features

# 5. Create PR with detailed testing checklist
gh pr create \
  --title "fix(security): High - Update package-name" \
  --body "**Testing Checklist:**
- [ ] Unit tests pass
- [ ] Integration tests pass
- [ ] E2E tests pass
- [ ] Manual testing completed
- [ ] No breaking changes
- [ ] Performance regression check"

# 6. Deploy after thorough review
```

## ðŸŸ¡ Moderate Vulnerability Response

### Evaluation (< 24 hours)

```markdown
**Moderate Vulnerability Checklist:**

- [ ] Review CVE description
- [ ] Check if code path is reachable
- [ ] Assess likelihood of exploitation
- [ ] Determine if workaround exists
- [ ] Plan remediation timeline
```

### Remediation (< 1 week)

```bash
# Option 1: Batch with other updates
# - Group with Dependabot PR
# - Include in next sprint

# Option 2: Immediate fix if easy
npm audit fix
# Test, commit, deploy in next release

# Option 3: Implement workaround temporarily
# - Disable vulnerable feature
# - Add input validation
# - Schedule proper fix
```

## ðŸ”µ Low Vulnerability Response

### Review (< 1 week)

```markdown
**Low Priority Review:**

- Review vulnerability details
- Determine if fix is worth the risk
- Check for alternative solutions
- Plan inclusion in routine updates
```

### Remediation (< 2 weeks)

```bash
# Include in regular dependency updates
# - Let Dependabot handle via weekly PRs
# - Review and merge with other updates
# - Deploy in scheduled maintenance window
```

## ðŸ› ï¸ Remediation Tools

### npm audit Commands

```bash
# Check all vulnerabilities
npm audit

# Check specific severity
npm audit --audit-level=moderate
npm audit --audit-level=high
npm audit --audit-level=critical

# Generate JSON report
npm audit --json > audit-report.json

# Fix automatically (safe updates)
npm audit fix

# Fix with breaking changes (use with caution)
npm audit fix --force

# Dry run (preview changes)
npm audit fix --dry-run
```

### Python Safety Commands

```bash
# Check Python vulnerabilities
cd tools/llamaindex
safety check --file requirements.txt

# Generate JSON report
safety check --file requirements.txt --json > safety-report.json

# Update vulnerable packages
pip install --upgrade package-name

# Update all packages (use with caution)
pip list --outdated
pip install --upgrade package1 package2
```

### Docker Image Scanning

```bash
# Scan Docker image for vulnerabilities
docker scan image-name:tag

# Check specific image
docker scan postgres:16

# Update base image
# Edit Dockerfile:
FROM postgres:16.2  # Update version

# Rebuild image
docker compose build --no-cache
```

## ðŸ“Š Tracking Remediation

### GitHub Security Tab

**Location:** GitHub â†’ Security â†’ Dependabot alerts

**Views:**
- **Open alerts:** Active vulnerabilities
- **Closed alerts:** Resolved vulnerabilities
- **Dismissed alerts:** False positives/accepted risks

**Workflow:**
1. Alert created automatically
2. Mark as "In Progress" when starting work
3. Create PR with fix
4. GitHub auto-closes alert when PR merges
5. Or manually close with reason

### Remediation Metrics

```markdown
**Weekly Metrics:**

| Metric | Target | Current |
|--------|--------|---------|
| Open Critical | 0 | TBD |
| Open High | 0 | TBD |
| MTTR (Critical) | < 24h | TBD |
| MTTR (High) | < 48h | TBD |
| Total Open | < 10 | TBD |
```

## âš ï¸ Special Cases

### Vulnerability with No Fix Available

```markdown
**Actions:**

1. **Document the issue**
   - Create internal security advisory
   - Document impact and workarounds

2. **Implement workaround**
   - Disable vulnerable feature
   - Add input validation
   - Implement rate limiting

3. **Monitor for fix**
   - Subscribe to package updates
   - Check upstream issues daily
   - Test pre-release versions

4. **Consider alternatives**
   - Switch to alternative package
   - Fork and patch yourself
   - Rewrite functionality
```

### Breaking Changes Required

```markdown
**Process:**

1. **Create feature branch**
   \`\`\`bash
   git checkout -b security/major-update-package-name
   \`\`\`

2. **Update dependencies**
   \`\`\`bash
   npm install package-name@latest
   \`\`\`

3. **Fix breaking changes**
   - Review migration guide
   - Update code for new API
   - Update tests

4. **Thorough testing**
   - Run full test suite
   - Manual regression testing
   - Performance testing

5. **Staged rollout**
   - Deploy to staging first
   - Monitor for issues
   - Deploy to production gradually
```

### Multiple Vulnerabilities

```markdown
**Prioritization:**

1. **Critical + High:** Fix immediately (< 24-48h)
2. **Moderate:** Batch together (< 1 week)
3. **Low:** Include in regular updates (< 2 weeks)

**Batching Strategy:**
\`\`\`bash
# Create single branch for all fixes
git checkout -b security/batch-updates-2025-11-11

# Fix all critical/high
cd frontend/dashboard && npm audit fix
cd backend/api/workspace && npm audit fix

# Test thoroughly
npm run test:all

# Single PR with all fixes
gh pr create --title "fix(security): Batch security updates"
\`\`\`
```

## ðŸ“š Best Practices

### âœ… DO

1. **Respond Quickly** - Acknowledge alerts within response time
2. **Test Thoroughly** - Especially for high/critical fixes
3. **Document Changes** - Clear commit messages with CVE numbers
4. **Communicate Impact** - Inform team of critical vulnerabilities
5. **Verify Fixes** - Ensure vulnerability is actually resolved
6. **Update Dependencies Regularly** - Prevent accumulation
7. **Monitor Upstream** - Track security advisories for key packages

### âŒ DON'T

1. **Don't Ignore Alerts** - All vulnerabilities need response
2. **Don't Skip Testing** - Even for "simple" updates
3. **Don't Force Update Blindly** - `npm audit fix --force` can break things
4. **Don't Dismiss Without Investigation** - Understand impact first
5. **Don't Deploy Untested Fixes** - Test in staging first
6. **Don't Batch Critical with Low** - Different timelines
7. **Don't Assume Safe** - Verify fix resolves issue

## ðŸ†˜ Escalation Process

### When to Escalate

```markdown
**Escalate if:**

- Cannot fix within timeline
- No fix available upstream
- Breaking changes required
- Production incident ongoing
- Unsure about impact
- Need architecture change
```

### Escalation Contacts

```markdown
**Level 1:** Team Lead
- Review remediation plan
- Approve breaking changes
- Coordinate deployment

**Level 2:** Security Team
- Complex vulnerability assessment
- No-fix-available situations
- Policy exceptions

**Level 3:** Management
- Business impact decisions
- Resource allocation
- Customer communication
```

## ðŸ“– References

### Tools & Resources

- [npm audit Documentation](https://docs.npmjs.com/cli/v9/commands/npm-audit)
- [Safety (Python)](https://pypi.org/project/safety/)
- [CVE Database](https://cve.mitre.org/)
- [NIST NVD](https://nvd.nist.gov/)
- [Snyk Vulnerability Database](https://snyk.io/vuln/)

### TradingSystem Guides

- [Dependency Management](./dependency-management-guide.mdx)
- [Security Best Practices](./security-best-practices.mdx)
- [CI/CD Security](../ci-cd/security-guide.mdx)

### Internal Documentation

- **Security Policy:** `SECURITY.md`
- **Incident Response:** `docs/security/incident-response.md`
- **Security Contacts:** `docs/security/contacts.md`

---

**Last Updated:** 2025-11-11
**Version:** 1.0 (Phase 1.3 Implementation)
**Next Review:** After first major incident
