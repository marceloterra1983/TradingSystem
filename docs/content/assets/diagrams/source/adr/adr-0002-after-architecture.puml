@startuml
title Architecture - After Agno Integration

actor Trader
component "Agno Agents\n:8200" as Agno {
  component "MarketAnalysisAgent" as Market
  component "RiskManagementAgent" as Risk
  component "SignalOrchestratorAgent" as Orchestrator
}
component "Workspace API\n:3100" as Workspace
component "TP Capital API\n:3200" as TPCapital
database "QuestDB" as QuestDB
component "Prometheus\n:9090" as Prometheus
component "Grafana\n:3000" as Grafana

Trader --> Agno : POST /api/v1/agents/analyze
Orchestrator --> Market : Request analysis
Orchestrator --> Risk : Validate signal
Market --> Workspace : Fetch ideas
Market --> TPCapital : Get signals
TPCapital --> QuestDB : Query signals
Agno --> Prometheus : Export metrics
Prometheus --> Grafana : Visualize dashboards

note right of Agno
  Improvements:
  - Automated decision-making
  - Coordinated multi-agent workflow
  - Real-time risk validation
  - <500ms response time (p95)
  - Circuit breaker & retry resilience
  - Comprehensive observability
  - Parallel data fetching
end note

note bottom of Trader
  Novo workflow:
  1. Enviar requisição ao Agno
  2. Receber sinais aprovados em <2s
  3. Revisar recomendações com justificativas
  4. Executar trades com confiança

  Ganho: 150-300x mais rápido
end note

note bottom of Prometheus
  Métricas disponíveis:
  - agent_decisions_total
  - agent_processing_seconds
  - agent_errors_total
  - dependency_status
end note

@enduml
