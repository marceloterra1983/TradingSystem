# TradingSystem Docs

This directory hosts the Docusaurus v3 workspace that replaced the legacy `docs/`
site (now archived under `docs_legacy/`) after the migration phases described in
`tools/openspec/changes/migrate-docs-to-docusaurus-v2/tasks.md`.

## Local development

```bash
npm install
npm run docs:dev
```

The dev server listens on `http://localhost:3400` by default; pass `--port` to override (for CI smoke tests we use `npm run docs:dev -- --host 127.0.0.1 --port 3400`).

Refer to the tasks file for the full rollout plan and outstanding items; see `package.json` for the exact dependency versions.

## Automation & helpers

- `npm run docs:auto` generates documentation from source files (ports table, design tokens) and flags MCP registry blockers.
- `npm run docs:validate-generated` checks structure of auto-generated sections (markers, timestamps, tables).
- `npm run docs:check` runs docs:auto ‚Üí docs:validate-generated ‚Üí lint ‚Üí type-check ‚Üí tests ‚Üí build.
- `npm run docs:links` rebuilds the site and runs `linkinator` over the static output (requires internet for external URLs if any).
- `npm run docs:test` runs Node-based unit tests for the automation helpers.
- Run `bash ../scripts/docs/new.sh <section/slug> --title "Title"` to scaffold a new MDX page with the required frontmatter.
- Shell wrappers under `scripts/docs/` mirror these commands for CI pipelines, including `check-links.sh`.
- Husky hooks run `npm --prefix docs run docs:auto` then `docs:lint` on commit and `docs:check` on push; export `SKIP_DOCS_AUTO=1` to skip only the auto-generation step or `SKIP_DOCS_HOOKS=1` to bypass the hook entirely in emergencies.

## Versioning

**The documentation uses Docusaurus versioning to maintain snapshots aligned with system releases.**

### Creating a New Version

```bash
# After Phase 6 launch or major release
cd docs
npx docusaurus docs:version 1.0.0

# Verify snapshot created
npm run docs:version:list
```

### Version Management Commands

```bash
# List all versions
npm run docs:version:list

# Build only current version (fast dev builds)
npm run docs:build:fast

# Build all versions (production)
npm run docs:build
```

### Version Strategy

- **current** (Next): Unreleased development version at `/next/`
- **Latest Stable**: Most recent release at `/` (root path)
- **Retention Policy**: Keep current + 2 latest stable versions
- **Naming**: Semantic versioning (1.0.0, 2.0.0, etc.)

### Build Performance

- **Dev builds**: ~45s (current version only)
- **Production builds**: ~75-105s (all active versions)
- **Target**: < 120s with 3 versions

### Version Labels

- **Next (Unreleased) üöß** - Development version with unreleased banner
- **X.X.X (Stable) ‚úÖ** - Latest stable version (no banner)
- **X.X.X** - Older versions with "outdated" banner

**For detailed versioning procedures, see `governance/VERSIONING-GUIDE.md`**

## Generated Content

**Overview**:
- Generated sections live inside `<!-- BEGIN AUTO-GENERATED ... -->` markers and are overwritten by `npm run docs:auto`.
- Manual narrative layers (port ranges, troubleshooting, etc.) sit outside the markers and remain editable.

**Generated Files**:

| File | Source | Generator | Status |
|------|--------|-----------|--------|
| `content/tools/ports-services.mdx` | `docs/context/ops/service-port-map.md` | Ports table parser | ‚úÖ Active |
| `content/frontend/design-system/tokens.mdx` | `frontend/dashboard/tailwind.config.js` | Tailwind token extractor | ‚úÖ Active |
| `content/mcp/registry.mdx` | `~/.claude.json`, `claude/mcp-servers.json` | MCP registry sync | ‚ö†Ô∏è TODO (blocked) |

**How to Regenerate**:

```bash
# Regenerate all documentation outputs
npm run docs:auto

# Verify generated structure before committing
npm run docs:validate-generated

# Full pipeline (pre-push hook runs this automatically)
npm run docs:check
```

**Generation Markers**:
- Comments like `<!-- AUTO-GENERATED by docs:auto - DO NOT EDIT MANUALLY -->` and `<!-- Last generated: ... -->` are updated on each run.
- Content between BEGIN/END markers is replaced; edits should live above or below the markers.

**When to Regenerate**:
- After editing `service-port-map.md` or `tailwind.config.js`.
- Before committing documentation changes (pre-commit does this automatically).
- Prior to publishing or pushing (pre-push hook runs `docs:check`).

**Troubleshooting**:
- Missing tables? Re-run `npm run docs:auto` then `npm run docs:validate-generated`.
- Parsing errors? Confirm source markdown tables and Tailwind config follow the expected structure.
- Need to bypass automation temporarily? Export `SKIP_DOCS_AUTO=1` to skip generation (lint still runs) or `SKIP_DOCS_HOOKS=1` to skip everything; remember to regenerate before merging.

## Migration Status

**Current Phase:** üîÑ Phase 5 - Review & Governance

**Phase 5 Deliverables**:
- ‚è≥ Chapter-by-chapter review with owners (see `governance/REVIEW-CHECKLIST.md`)
- ‚è≥ Quarterly maintenance checklist (see `governance/MAINTENANCE-CHECKLIST.md`)
- ‚è≥ README updates with navigation (in progress)
- ‚è≥ Internal communications plan (see `governance/COMMUNICATION-PLAN.md`)
- ‚è≥ Full validation suite execution (see `governance/VALIDATION-GUIDE.md`)

**Previous Phases**:
- ‚úÖ Phase 0: Preparation (catalog, mapping, inventory)
- ‚úÖ Phase 1-3: Content migration (apps, frontend, tools, database, security, PRD, SDD)
- ‚úÖ Phase 4: Automation (ports table, design tokens, validation suite)

**Next Phase**: Phase 6 - Update References & Cut-over

**Migration Resources**:
- Migration artifacts: `docs/migration/`
- Migration tasks: `tools/openspec/changes/migrate-docs-to-docusaurus-v2/tasks.md`
- Legacy docs: `docs/README.md`
- Governance hub sources: `governance/`

**For Reviewers**:
1. Review assigned chapters in `governance/REVIEW-CHECKLIST.md`
2. Validate content quality and technical accuracy
3. Test procedures and commands
4. Sign off on chapter completion
5. Report issues in #docs-migration channel

**For Stakeholders**:
Review `migration/INVENTORY-REPORT.md` for executive summary and launch timeline.

## Content Structure

**docs organizes documentation into 12 primary categories:**

### 1. Apps (20 files)
**Path**: `content/apps/`
**Owner**: DocsOps
**Coverage**: Workspace, TP Capital, Order Manager, Data Capture
**Sections per app**: overview, requirements, architecture, config, deployment, operations, runbook, changelog, api

### 2. APIs (3 files)
**Path**: `content/api/`
**Owner**: ArchitectureGuild
**Coverage**: Order Manager, Data Capture, Workspace
**Content**: API summaries, resource lists, Redoc links

### 3. Frontend (14 files)
**Path**: `content/frontend/`
**Owner**: FrontendGuild
**Categories**: design-system (4), guidelines (4), engineering (5)
**Content**: Tokens, components, theming, patterns, style guide, accessibility, i18n, performance, architecture, conventions, testing, build-ci

### 4. Database (4 files)
**Path**: `content/database/`
**Owner**: DataOps / BackendGuild
**Content**: Overview, schema, migrations, retention-backup
**Coverage**: QuestDB, TimescaleDB, LowDB, Parquet

### 5. Tools (46 files)
**Path**: `content/tools/`
**Owner**: ToolingGuild / DocsOps
**Tools Documented**: node-npm, dotnet, python, docusaurus, redocusaurus, linting, docker-wsl, plantuml, security-config, ports-services
**Sections per tool**: overview, install, commands, config, troubleshooting, changelog

### 6. SDD (12 files)
**Path**: `content/sdd/`
**Owner**: ArchitectureGuild
**Categories**: domain/schemas (3), events (2), flows (2), api specs (5)
**Content**: Order schema, risk rules, order-created event, place-order flow, cancel-order flow, API specifications

### 7. PRD (6 files)
**Path**: `content/prd/`
**Owner**: ProductOps
**Products**: trading-app (overview + features)
**Templates**: prd-template, feature-template
**Languages**: EN + PT versions

### 8. Prompts (4 files)
**Path**: `content/prompts/`
**Owner**: PromptOps / MCPGuild
**Content**: Patterns, style-guide, variables, overview
**Coverage**: LlamaIndex, Ollama

### 9. Agents (6 files)
**Path**: `content/agents/`
**Owner**: MCPGuild / BackendGuild
**Content**: Legacy agents removed (new automation TBD)

### 10. MCP (3 files)
**Path**: `content/mcp/`
**Owner**: MCPGuild
**Content**: Registry, transports, permissions
**Status**: Manual (automation blocked - configs external)

### 11. Diagrams (1 file + 26 sources)
**Path**: `content/diagrams/` + `assets/diagrams/source/`
**Owner**: DocsOps
**Content**: 26 PlantUML diagrams (sequence, component, state, deployment)
**Organization**: Domain subdirectories (backend, frontend, ops, agents, adr, shared)

### 12. Reference (13 files)
**Path**: `content/reference/`
**Owner**: DocsOps / ArchitectureGuild
**Content**: Templates (page, guide, runbook, adr, tool, sdd, prd), ADRs, specs

### Root Pages (3 files)
- `index.mdx` - Documentation home page
- `changelog.mdx` - Central changelog index
- `faq.mdx` - Frequently asked questions

---

## Quick Navigation

**By Role**:
- **Developers**: Start with [Apps](content/apps/), [Frontend](content/frontend/), [Tools](content/tools/)
- **Operators**: See [Apps Operations](content/apps/*/operations.mdx), [Runbooks](content/apps/*/runbook.mdx), [Database](content/database/)
- **Product Managers**: Review [PRD](content/prd/), [Features](content/prd/products/trading-app/)
- **Architects**: Explore [SDD](content/sdd/), [APIs](content/api/), [Reference](content/reference/)
- **Contributors**: Check [Templates](content/reference/templates/), [FAQ](content/faq.mdx)

**By Task**:
- **Deploy an app**: `content/apps/<app-name>/deployment.mdx`
- **Troubleshoot incident**: `content/apps/<app-name>/runbook.mdx`
- **Understand API**: `content/api/<api-name>.mdx` ‚Üí `content/sdd/api/<api-name>/v1/spec.mdx`
- **Configure environment**: `content/tools/security-config/env.mdx`
- **Design new feature**: `content/prd/templates/feature-template.mdx`
- **Document decision**: `content/reference/templates/adr.mdx`

**By Technology**:
- **Node.js**: `content/tools/node-npm/`
- **.NET**: `content/tools/dotnet/`
- **Python**: `content/tools/python/`
- **Docker**: `content/tools/docker-wsl/`
- **Database**: `content/database/`

---

## Launch Readiness

**Current Status**: üîÑ Phase 5 - Review & Governance

**Launch Checklist**:
- [ ] All 135 files reviewed and approved by owners
- [ ] Full validation suite passes (docs:check, validate-frontmatter.py, docs:links)
- [ ] All critical issues resolved (P0, P1)
- [ ] Stakeholder sign-offs complete (DocsOps, ProductOps, ArchitectureGuild)
- [ ] Internal communications sent (Slack, email, dashboard)
- [ ] Redirect plan ready (docs_legacy ‚Üí docs)
- [ ] Rollback plan documented
- [ ] Go/No-Go decision approved

**Validation Status**:
- ‚è≥ Chapter-by-chapter review (see `governance/REVIEW-CHECKLIST.md`)
- ‚è≥ Frontmatter validation (run `validate-frontmatter.py`)
- ‚è≥ Link validation (run `docs:links`)
- ‚è≥ Build validation (run `docs:check`)
- ‚è≥ Stakeholder approvals (see review checklist)

**Launch Timeline**:
- **Week 1** (Oct 24-31): Apps, API, SDD review
- **Week 2** (Oct 31 - Nov 7): Frontend, Database, Tools, PRD review
- **Week 3** (Nov 7-14): Prompts, Agents, Reference, Diagrams, FAQ review
- **Week 3** (Nov 14-15): Final validation and launch
- **Week 4** (Nov 15-22): Post-launch monitoring and feedback

**Post-Launch**:
- Monitor for broken links (run docs:links weekly)
- Track user feedback (#docs-feedback channel)
- Address issues within 48 hours (P0/P1) or 1 week (P2/P3)
- Schedule first quarterly review (Q1 2026)
