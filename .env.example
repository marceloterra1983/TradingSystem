# ==============================================================================
# TradingSystem – Minimal Environment Template
# ==============================================================================
# This file only keeps the secrets and per-installation tokens that cannot live
# in versioned defaults. All non-secret defaults stay in `config/.env.defaults`
# and host/port mappings are generated under `.env.shared` via `npm run ports:sync`.
#
# ✅ Steps
# 1. cp .env.example .env
# 2. bash scripts/env/setup-env.sh        # auto-generates strong passwords
# 3. Fill every CHANGE_ME_* placeholder below
# 4. bash scripts/env/validate-env.sh     # ensures consistency
# 5. Keep `.env` untracked; commit only template updates
#
# Reference: governance/controls/ENVIRONMENT-VARIABLES-POLICY.md
# Detailed matrix: docs/content/tools/security-config/env.mdx
# ==============================================================================

# =============================================================================
# 0-GATEWAY-STACK
# =============================================================================

# Service-to-Service Secrets
GATEWAY_SECRET_TOKEN="CHANGE_ME_GATEWAY_SECRET"
API_SECRET_TOKEN="CHANGE_ME_SHARED_TOKEN"
INTER_SERVICE_SECRET="CHANGE_ME_INTER_SERVICE_SECRET"
VITE_GATEWAY_TOKEN="CHANGE_ME_DASHBOARD_GATEWAY_TOKEN"

# Provedores Externos (Globais)
OPENAI_API_KEY="CHANGE_ME_OPENAI_API_KEY"
OPENAI_BASE_URL=https://api.openai.com/v1
LANGSMITH_API_KEY="CHANGE_ME_LANGSMITH_KEY"
LANGSMITH_PROJECT=tradingsystem-dev
LANGSMITH_TRACING=true
ANTHROPIC_API_KEY=""
FIRECRAWL_API_KEY=""
ANYTHINGLLM_API_KEY=""
ANYTHINGLLM_URL=http://localhost:3899
ANYTHINGLLM_WORKSPACE_SLUG=dash-dashboard
GITHUB_TOKEN=""
SLACK_WEBHOOK_URL=""
SENTRY_AUTH_TOKEN=""
GF_SECURITY_ADMIN_PASSWORD="CHANGE_ME_GRAFANA"

# =============================================================================
# 1-DASHBOARD-STACK
# =============================================================================

# HTTP Client Configuration (STD-020)
VITE_API_GATEWAY_URL=http://localhost:9082
VITE_INTER_SERVICE_SECRET="CHANGE_ME_INTER_SERVICE_SECRET"  # Same as above for consistency

# Optional: HTTP Client Timeouts (milliseconds)
VITE_HTTP_TIMEOUT_DEFAULT=15000
VITE_HTTP_TIMEOUT_HEALTH_CHECK=5000
VITE_HTTP_TIMEOUT_QUICK_READ=10000
VITE_HTTP_TIMEOUT_STANDARD_READ=15000
VITE_HTTP_TIMEOUT_WRITE=30000
VITE_HTTP_TIMEOUT_LONG_OPERATION=120000
VITE_HTTP_TIMEOUT_FILE_UPLOAD=300000

# Circuit Breaker Configuration
VITE_CIRCUIT_BREAKER_ENABLED=true
VITE_CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
VITE_CIRCUIT_BREAKER_RESET_TIMEOUT=30000
VITE_CIRCUIT_BREAKER_MONITORING_PERIOD=10000

# HTTP Retry Configuration
VITE_HTTP_RETRY_ENABLED=true
VITE_HTTP_RETRY_MAX_ATTEMPTS=3

# Request Queue Configuration
VITE_HTTP_MAX_CONCURRENT_REQUESTS=10

# Logging Configuration
VITE_HTTP_LOGGING_ENABLED=true  # Set to false in production

# (Dashboard usa principalmente variáveis públicas - ver config/.env.defaults)
# Adicionar aqui qualquer secret específico do dashboard quando necessário

# =============================================================================
# 2-DOCS-STACK
# =============================================================================

# (Docs usa principalmente variáveis públicas - ver config/.env.defaults)
# Adicionar aqui qualquer secret específico da documentação quando necessário

# =============================================================================
# 4-1-TP-CAPITAL-STACK
# =============================================================================

TP_CAPITAL_API_KEY="CHANGE_ME_TP_CAPITAL_API_KEY"
VITE_TP_CAPITAL_API_KEY="CHANGE_ME_TP_CAPITAL_FRONTEND_KEY"
TP_CAPITAL_DB_PASSWORD="CHANGE_ME_AUTO"
TP_CAPITAL_SIGNALS_CHANNEL_ID=-1001234567890
TP_CAPITAL_GATEWAY_FILTER_TEXT_CONTAINS=

# =============================================================================
# 4-2-TELEGRAM-STACK
# =============================================================================

## Credenciais Telegram e Sessão
TELEGRAM_API_ID=
TELEGRAM_API_HASH=
TELEGRAM_PHONE_NUMBER=+5500000000000
TELEGRAM_SESSION=""
TELEGRAM_SESSION_ENCRYPTION_KEY="CHANGE_ME_SESSION_KEY"
TELEGRAM_SIGNALS_CHANNEL_ID=-1001234567890

## Tokens / Chaves
TELEGRAM_BOT_TOKEN=""
TELEGRAM_INGESTION_BOT_TOKEN=""
TELEGRAM_FORWARDER_BOT_TOKEN=""
TELEGRAM_GATEWAY_API_KEY="CHANGE_ME_TG_API_KEY"
TELEGRAM_GATEWAY_API_TOKEN="CHANGE_ME_TG_API_TOKEN"
VITE_TELEGRAM_GATEWAY_API_URL=http://localhost:4010
VITE_TELEGRAM_GATEWAY_API_TOKEN="CHANGE_ME_GATEWAY_TOKEN"

## Senhas de Serviços Internos
TELEGRAM_DB_PASSWORD="CHANGE_ME_AUTO"
TELEGRAM_GATEWAY_DB_PASSWORD="CHANGE_ME_AUTO"
GATEWAY_DATABASE_PASSWORD="CHANGE_ME_AUTO"
RABBITMQ_PASSWORD="CHANGE_ME_AUTO"
TELEGRAM_RABBITMQ_PASSWORD="CHANGE_ME_AUTO"

## Configurações
TELEGRAM_MODE=polling

# =============================================================================
# 4-3-WORKSPACE-STACK
# =============================================================================

WORKSPACE_DB_PASSWORD="CHANGE_ME_AUTO"
WORKSPACE_DATABASE_PASSWORD="CHANGE_ME_AUTO"
POSTGRES_PASSWORD="CHANGE_ME_AUTO"

# Opcional: Neon Workspace Override (se LIBRARY_DB_STRATEGY=neon)
NEON_HOST=localhost
NEON_PORT=5433
NEON_DATABASE=workspace
NEON_USER=postgres
NEON_PASSWORD=""
NEON_SCHEMA=workspace
NEON_POOL_MAX=20
NEON_POOL_MIN=2
NEON_IDLE_TIMEOUT=30000
NEON_CONNECTION_TIMEOUT=5000
NEON_STATEMENT_TIMEOUT=30000
NEON_QUERY_TIMEOUT=30000
NEON_SSL=false

# =============================================================================
# 4-4-RAG-STACK
# =============================================================================

# (RAG usa principalmente variáveis públicas - ver config/.env.defaults)
# Adicionar aqui qualquer secret específico do RAG quando necessário

# =============================================================================
# 4-5-COURSE-CRAWLER-STACK
# =============================================================================

COURSE_CRAWLER_MAX_CLASSES_PER_MODULE=50
COURSE_CRAWLER_ENCRYPTION_KEY="CHANGE_ME_COURSE_CRAWLER_KEY"

# =============================================================================
# 5-1-N8N-STACK
# =============================================================================

N8N_BASIC_AUTH_PASSWORD="CHANGE_ME_N8N_PASSWORD"
N8N_ENCRYPTION_KEY="CHANGE_ME_N8N_ENCRYPTION_KEY"
N8N_E2E_PASSWORD="CHANGE_ME_N8N_E2E_PASSWORD"
N8N_POSTGRES_PASSWORD="CHANGE_ME_AUTO"
N8N_REDIS_PASSWORD="CHANGE_ME_AUTO"
N8N_PATH=/n8n
N8N_BASE_URL=http://localhost:3103/n8n
N8N_EDITOR_BASE_URL=http://localhost:3103/n8n
N8N_API_BASE_URL=http://localhost:3103/n8n/api
N8N_WEBHOOK_URL=http://localhost:3103/n8n/
WEBHOOK_URL=http://localhost:3103/n8n/
N8N_SESSION_COOKIE_DOMAIN=localhost
N8N_SESSION_COOKIE_SAME_SITE=lax

# =============================================================================
# 5-2-EVOLUTION-API-STACK
# =============================================================================

# (Evolution API - adicionar variáveis quando implementado)

# =============================================================================
# 5-3-WAHA-STACK (WhatsApp)
# =============================================================================

## WAHA Core
WAHA_IMAGE=devlikeapro/waha:latest-baileys
WAHA_PORT=3310
WAHA_HOST_BIND=127.0.0.1
WAHA_TZ=America/Sao_Paulo
WAHA_API_KEY="CHANGE_ME_WAHA_API_KEY"
WAHA_API_KEY_PLAIN="CHANGE_ME_WAHA_API_KEY"
WAHA_DASHBOARD_USERNAME=admin
WAHA_DASHBOARD_PASSWORD="CHANGE_ME_WAHA_DASHBOARD"
WAHA_DASHBOARD_ENABLED=true
WHATSAPP_SWAGGER_USERNAME=admin
WHATSAPP_SWAGGER_PASSWORD="CHANGE_ME_WAHA_SWAGGER"
WHATSAPP_SWAGGER_ENABLED=true
WAHA_DEFAULT_ENGINE=BAILEYS
WAHA_BASE_URL=http://localhost:3310
WAHA_PUBLIC_URL=http://localhost:3310
WAHA_HOSTNAME=0.0.0.0
WAHA_INTERNAL_PORT=3000
WAHA_MEDIA_STORAGE=S3
WAHA_PRINT_QR=false
WAHA_LOG_FORMAT=JSON
WAHA_LOG_LEVEL=info

## WAHA PostgreSQL
WAHA_POSTGRES_HOST_BIND=127.0.0.1
WAHA_POSTGRES_PORT=5438
WAHA_POSTGRES_DB=waha
WAHA_POSTGRES_USER=waha
WAHA_POSTGRES_PASSWORD="CHANGE_ME_WAHA_DB_PASS"

## WAHA MinIO (S3 Storage)
WAHA_MINIO_HOST_BIND=127.0.0.1
WAHA_MINIO_API_PORT=9300
WAHA_MINIO_CONSOLE_HOST_BIND=127.0.0.1
WAHA_MINIO_CONSOLE_PORT=9301
WAHA_MINIO_BUCKET=waha-media
WAHA_MINIO_REGION=us-east-1
WAHA_MINIO_ROOT_USER=wahaadmin
WAHA_MINIO_ROOT_PASSWORD="CHANGE_ME_WAHA_MINIO"
WAHA_S3_PROXY_FILES=true

## WAHA Webhook
WAHA_WEBHOOK_HOST_BIND=127.0.0.1
WAHA_WEBHOOK_PORT=3908
WAHA_WEBHOOK_TOKEN="CHANGE_ME_WAHA_WEBHOOK_TOKEN"
WAHA_HOOK_URL=http://waha-webhook:3908/webhooks/waha
WAHA_HOOK_EVENTS=message,message.ack,session.status
WAHA_HOOK_CUSTOM_HEADERS=X-WAHA-TOKEN:${WAHA_WEBHOOK_TOKEN}

# =============================================================================
# 5-5-KESTRA-STACK (Workflow Orchestration)
# =============================================================================

KESTRA_DB_HOST=kestra-postgres
KESTRA_DB_PORT=5455
KESTRA_DB_NAME=kestra
KESTRA_DB_USER=kestra
KESTRA_DB_PASSWORD="CHANGE_ME_KESTRA_DB"
KESTRA_BASICAUTH_USERNAME=admin@tradingsystem.local
KESTRA_BASICAUTH_PASSWORD="CHANGE_ME_KESTRA_UI"
KESTRA_HTTP_PORT=8180
KESTRA_MANAGEMENT_PORT=8181
KESTRA_WORKDIR_DIR=./tools/kestra/workdir
KESTRA_STORAGE_DIR=./tools/kestra/storage

# =============================================================================
# 5-7-FIRECRAWL-STACK
# =============================================================================

# Firecrawl Database
FIRECRAWL_DB_PASSWORD="CHANGE_ME_AUTO"

# Firecrawl Integrations (Opcional)
FIRECRAWL__DATABASE__SUPABASE_URL=
FIRECRAWL__DATABASE__SUPABASE_SERVICE_TOKEN=
FIRECRAWL__DATABASE__SUPABASE_ANON_TOKEN=
FIRECRAWL__SEARCH__SERPER_API_KEY=
FIRECRAWL__SEARCH__SEARCHAPI_API_KEY=
FIRECRAWL__NOTIFICATIONS__SLACK_WEBHOOK_URL=
FIRECRAWL__ANALYTICS__POSTHOG_API_KEY=
FIRECRAWL__ANALYTICS__POSTHOG_HOST=https://app.posthog.com
FIRECRAWL__WEBHOOKS__SELF_HOSTED_URL=
FIRECRAWL__PROXY__SERVER=
FIRECRAWL__PROXY__USERNAME=
FIRECRAWL__PROXY__PASSWORD=
FIRECRAWL__TEST__API_KEY=

# =============================================================================
# 6-1-MONITORING-STACK
# =============================================================================

PROMETHEUS_PORT=9091
GRAFANA_PORT=3101

# Database Credentials
TIMESCALE_POSTGRES_PASSWORD="CHANGE_ME_AUTO"
TIMESCALEDB_PASSWORD="CHANGE_ME_AUTO"
REDIS_PASSWORD="CHANGE_ME_AUTO"

# Database UI Tools
ADMINER_PORT=8082
ADMINER_IMAGE=adminer:latest
PGADMIN_HOST_PORT=5050
PGADMIN_IMAGE_TAG=latest
PGADMIN_DEFAULT_EMAIL=admin@tradingsystem.local
PGADMIN_DEFAULT_PASSWORD="CHANGE_ME_PGADMIN"
PGWEB_HOST_PORT=8081
PGWEB_IMAGE_TAG=latest
PGWEB_DATABASE_URL=postgresql://postgres:postgres@host.docker.internal:5433/postgres?sslmode=disable

# Database Tools API
DB_TOOLS_API_PORT=3909
DB_TOOLS_API_TOKEN="CHANGE_ME_DB_TOOLS_TOKEN"
VITE_DB_TOOLS_API_URL=http://localhost:3909
VITE_DB_TOOLS_API_TOKEN=${DB_TOOLS_API_TOKEN}

# =============================================================================
# OUTRAS VARIÁVEIS (não identificadas nas stacks acima)
# =============================================================================

# Documentation API
APP_DOCUMENTATION_DB_PASSWORD="CHANGE_ME_AUTO"

# Frontend Apps (Read-Only DB Access)
FRONTEND_APPS_DB_READONLY_PASS="CHANGE_ME_AUTO"

# MCP Server
MCP_POSTGRES_URL=postgres://frontend_ro:CHANGE_ME_RO_PASS@localhost:5433/trading?sslmode=disable

# ==============================================================================
# ✅ Validation Helpers
# ==============================================================================
# - bash scripts/env/validate-env.sh      # schema + required keys
# - bash scripts/env/print-env-summary.sh # quick diff between .env & defaults
# - npm run ports:sync                    # rebuilds .env.shared from registry
#
# Never commit `.env`; treat this template + governance policy as the source of
# truth for new variables. If you introduce a new secret:
# 1. Add the default (safe) value to config/.env.defaults
# 2. Document it in docs/content/tools/security-config/env.mdx
# 3. Append the placeholder here (if it cannot be versioned)
# 4. Update governance/controls/ENVIRONMENT-VARIABLES-POLICY.md
# ==============================================================================
